

----QUIT----(9 March 2021 14:58:42) CuisUniversity-4532.image priorSource: 13044060!

----STARTUP---- (9 March 2021 14:58:43) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-4532.image!


----QUIT----(9 March 2021 14:58:43) CuisUniversity-4532.image priorSource: 16885479!

----STARTUP---- (3 June 2021 17:22:07) as /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/CuisUniversity-4532.image!


----End fileIn of /Users/crivera/Documents/Facultad/IS1/Nuestras-entregas/18-Portfolio 2/Portfolio-Solucion-Tests.st----!

----End fileIn of /Users/crivera/Documents/Facultad/IS1/Nuestras-entregas/18-Portfolio 2/Portfolio-Solucion.st----!

----End fileIn of /Users/crivera/Documents/Facultad/IS1/Enunciados/19-MarsRover-El regreso/MarsRover-WithHeading.st----!

----QUIT----(3 June 2021 22:13:03) CuisUniversity-4532.image priorSource: 16885703!

----STARTUP---- (6 June 2021 20:53:10) as /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/CuisUniversity-4532.image!


----End fileIn of /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/Packages/TerseGuide.pck.st----!

----QUIT----(6 June 2021 21:15:23) CuisUniversity-4532.image priorSource: 16948947!

----STARTUP---- (8 June 2021 19:21:31) as /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/CuisUniversity-4532.image!


Object subclass: #CartTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!

!classDefinition: #CartTest category: 'TusLibros.com' stamp: 'lilmonk3y 6/8/2021 19:23:00'!
Object subclass: #CartTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!

!classDefinition: #Cart category: 'TusLibros.com' stamp: 'lilmonk3y 6/8/2021 19:39:45'!
Object subclass: #Cart
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!
!CartTest methodsFor: 'no messages' stamp: 'lilmonk3y 6/8/2021 19:39:35'!
test01
	| cart |
	cart _ Cart new.
	
	self assert: 0 equals: cart items size! !

TestCase subclass: #NameOfSubclass
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!

!classDefinition: #NameOfSubclass category: 'TusLibros.com' stamp: 'lilmonk3y 6/8/2021 19:40:00'!
TestCase subclass: #NameOfSubclass
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!

!classRemoval: #NameOfSubclass stamp: 'lilmonk3y 6/8/2021 19:40:11'!
TestCase subclass: #NameOfSubclass
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!

TestCase subclass: #CartTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!

!classDefinition: #CartTest category: 'TusLibros.com' stamp: 'lilmonk3y 6/8/2021 19:40:17'!
TestCase subclass: #CartTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 19:40:22'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:40:37'!
items
	self shouldBeImplemented.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:41:07' prior: 50864298!
items
	^ Bag new.! !

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 19:41:10'!
PASSED!

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 19:41:10'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:42:45'!
test02
	| cart |
	cart _ Cart new.
	
	cart addItem: nil.
	self assert: 0 equals: cart items size! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:46:44' prior: 50864311!
test02
	| cart |
	cart _ Cart new.
	
	cart addItem: 'unNombre'.
	
	self assert: 1 equals: cart items size! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:46:58' prior: 50864318!
test02
	| cart cartItems |
	cart _ Cart new.
	
	cart addItem: 'unNombre'.
	
	cartItems _ cart items.
	self assert: 1 equals: cartItems size! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:48:12' prior: 50864325!
test02
	| cart cartItems |
	cart _ Cart new.
	
	cart addItem: 'unNombre'.
	
	cartItems _ cart items.
	self assert: 1 equals: cartItems size.
	self assert: (cartItems includes: 'unNombre').! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:48:27' prior: 50864333!
test02
	| cart cartItems isbn |
	cart _ Cart new.
	
	isbn _ 'unNombre'.
	cart addItem: isbn.
	
	cartItems _ cart items.
	self assert: 1 equals: cartItems size.
	self assert: (cartItems includes: 'unNombre').! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:48:52' prior: 50864343!
test02
	| cart cartItems isbn |
	cart _ Cart new.
	isbn _ 'unNombre'.
	
	cart addItem: isbn.
	
	cartItems _ cart items.
	self assert: 1 equals: cartItems size.
	self assert: (cartItems includes: isbn).! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:49:50' prior: 50864353!
test02
	| cart cartItems isbn |
	cart _ Cart new.
	isbn _ '9780321146533'.
	
	cart addItem: isbn.
	
	cartItems _ cart items.
	self assert: 1 equals: cartItems size.
	self assert: (cartItems includes: isbn).! !

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 19:49:57'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:50:05'!
addItem: aString 
	self shouldBeImplemented.! !

!classDefinition: #Cart category: 'TusLibros.com' stamp: 'lilmonk3y 6/8/2021 19:50:35'!
Object subclass: #Cart
	instanceVariableNames: 'items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:50:29' prior: 50864375!
addItem: aString 
	items add: aString! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:50:48' prior: 50864387!
addItem: anItem 
	items add: anItem! !

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 19:51:53'!
ERROR!
!Cart methodsFor: 'nil' stamp: 'lilmonk3y 6/8/2021 19:52:36' overrides: 16896425!
initialize
	items _ Bag new! !

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 19:52:42'!
FAILURE!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:53:21' prior: 50864303!
items
	^ items .! !

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 19:53:23'!
PASSED!

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 19:53:23'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 19:53:23'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 19:58:51'!
test03
	| cart cartItems isbnOfTDDByExample |
	cart _ Cart new.
	isbnOfTDDByExample _ '9780321146533'.
	
	cart addItem: isbnOfTDDByExample.
	cart addItem: isbnOfTDDByExample.
		
	cartItems _ cart items.
	self assert: 2 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample).! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:03:33' prior: 50864417!
test03
	| cart cartItems isbnOfTDDByExample |
	cart _ Cart new.
	isbnOfTDDByExample _ '9780321146533'.
	
	cart addItem: isbnOfTDDByExample amount: 2.
		
	cartItems _ cart items.
	self assert: 2 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample).! !

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:03:43'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:03:49'!
addItem: aString amount: aSmallInteger 
	self shouldBeImplemented.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:05:07' prior: 50864444!
addItem: aString amount: aSmallInteger 
	items add: aString withOccurrences: aSmallInteger ! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:05:17' prior: 50864450!
addItem: anItem amount: aSmallInteger 
	items add: anItem withOccurrences: aSmallInteger ! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:05:25' prior: 50864456!
addItem: anItem amount: anAmount 
	items add: anItem withOccurrences: anAmount ! !

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:05:31'!
PASSED!

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 20:05:31'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 20:05:31'!
PASSED!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:05:31'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:14:03'!
test04
	| cart aCatalogue anInvalidISBN |
	aCatalogue _ Collection new.
	cart _ Cart forCatalogue: aCatalogue.
	anInvalidISBN _ '9780321146537'.
	
	self should: [cart addItem: anInvalidISBN] 
		raise: Error description: Cart isbnNotPresentInCatalogueErrorDescription.
		! !

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:14:35'!
ERROR!
!Cart class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:14:43'!
forCatalogue: aCollection 
	self shouldBeImplemented.! !
!Cart class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:15:09' prior: 50864491!
forCatalogue: aCollection 
	^ self new initializeWith: aCollection ! !

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:15:18'!
ERROR!

!classDefinition: #Cart category: 'TusLibros.com' stamp: 'lilmonk3y 6/8/2021 20:15:24'!
Object subclass: #Cart
	instanceVariableNames: 'items collection'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!
!Cart methodsFor: 'initialization' stamp: 'lilmonk3y 6/8/2021 20:15:24'!
initializeWith: aCollection 
	self shouldBeImplemented.
	collection := aCollection.! !

!classDefinition: #Cart category: 'TusLibros.com' stamp: 'lilmonk3y 6/8/2021 20:16:02'!
Object subclass: #Cart
	instanceVariableNames: 'items collection catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!
!Cart methodsFor: 'initialization' stamp: 'lilmonk3y 6/8/2021 20:15:59' prior: 50864510!
initializeWith: aCollection 
	catalogue := aCollection.! !

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:16:03'!
ERROR!
!Cart class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:16:12'!
isbnNotPresentInCatalogueErrorDescription
	self shouldBeImplemented.! !
!Cart class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:16:34' prior: 50864530!
isbnNotPresentInCatalogueErrorDescription
	^ 'isbnNotPresentInCatalogue'! !
!Cart class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:16:57' prior: 50864536!
isbnNotPresentInCatalogueErrorDescription
	^ 'isbn not present in catalogue'! !

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:16:58'!
FAILURE!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:17:03'!
PASSED!

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 20:17:03'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 20:17:03'!
PASSED!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:17:03'!
PASSED!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:17:03'!
FAILURE!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:17:03'!
FAILURE!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:17:07'!
FAILURE!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:17:47'!
FAILURE!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:18:25'!
FAILURE!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:20:34'!
PASSED!

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 20:20:34'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 20:20:34'!
PASSED!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:20:34'!
PASSED!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:20:34'!
FAILURE!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:20:34'!
FAILURE!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:20:52' prior: 50864477!
test04
	| cart aCatalogue anInvalidISBN |
	aCatalogue _ Collection new.
	cart _ Cart forCatalogue: aCatalogue.
	anInvalidISBN _ '9780321146537'.
	
	self should: [cart addItem: anInvalidISBN] 
		raise: [Error] description: Cart isbnNotPresentInCatalogueErrorDescription.
		! !

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:20:54'!
FAILURE!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:21:34' prior: 50864586!
test04
	| cart aCatalogue anInvalidISBN |
	aCatalogue _ Collection new.
	cart _ Cart forCatalogue: aCatalogue.
	anInvalidISBN _ '9780321146537'.
	
	self should: [cart addItem: anInvalidISBN] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription.
		! !

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:21:38'!
FAILURE!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:23:43' prior: 50864392!
addItem: anItem 
	(catalogue includes: anItem) ifFalse: [self error: self class isbnNotPresentInCatalogueErrorDescription ]
	items add: anItem! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:23:47' prior: 50864615!
addItem: anItem 
	(catalogue includes: anItem) ifFalse: [self error: self class isbnNotPresentInCatalogueErrorDescription ].
	items add: anItem! !

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:23:56'!
FAILURE!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:24:36'!
FAILURE!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:24:42'!
FAILURE!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:24:42'!
FAILURE!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:25:46' prior: 50864601!
test04
	| cart aCatalogue anInvalidISBN |
	aCatalogue _ Collection new.
	cart _ Cart forCatalogue: aCatalogue.
	anInvalidISBN _ '9780321146537'.
	self halt.
	self should: [cart addItem: anInvalidISBN] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription.
		! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:26:34' prior: 50864641!
test04
	| cart aCatalogue anInvalidISBN |
	aCatalogue _ OrderedCollection new.
	cart _ Cart forCatalogue: aCatalogue.
	anInvalidISBN _ '9780321146537'.
	self halt.
	self should: [cart addItem: anInvalidISBN] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription.
		! !

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:26:46'!
PASSED!

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 20:26:46'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 20:26:46'!
ERROR!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:26:46'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:26:54' prior: 50864654!
test04
	| cart aCatalogue anInvalidISBN |
	aCatalogue _ OrderedCollection new.
	cart _ Cart forCatalogue: aCatalogue.
	anInvalidISBN _ '9780321146537'.

	self should: [cart addItem: anInvalidISBN] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription.
		! !

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:26:59'!
PASSED!

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 20:26:59'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 20:26:59'!
ERROR!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:26:59'!
PASSED!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:26:59'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 20:26:59'!
ERROR!

!classDefinition: #CartTest category: 'TusLibros.com' stamp: 'lilmonk3y 6/8/2021 20:28:11'!
TestCase subclass: #CartTest
	instanceVariableNames: 'catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:28:10' overrides: 16927572!
setUp
	catalogue _ OrderedCollection new.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:28:54' prior: 50864676!
test04
	| cart anInvalidISBN |
	cart _ Cart forCatalogue: catalogue.
	anInvalidISBN _ '9780321146537'.

	self should: [cart addItem: anInvalidISBN] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription.
		! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:30:52' prior: 50864430!
test03
	| cart cartItems isbnOfTDDByExample |
	isbnOfTDDByExample _ '9780321146533'.
	catalogue add: isbnOfTDDByExample.
	cart _ Cart forCatalogue: catalogue.
	
	cart addItem: isbnOfTDDByExample amount: 2.
		
	cartItems _ cart items.
	self assert: 2 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample).! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:31:35' prior: 50864363!
test02
	| cart cartItems isbn |
	isbn _ '9780321146533'.
	catalogue add: isbn.
	cart _ Cart forCatalogue: catalogue.
	
	cart addItem: isbn.
	
	cartItems _ cart items.
	self assert: 1 equals: cartItems size.
	self assert: (cartItems includes: isbn).! !

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 20:31:39'!
PASSED!

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 20:31:39'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 20:31:39'!
PASSED!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:31:39'!
PASSED!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:31:39'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:34:40'!
test05
	| cart notExistingISBN |
	notExistingISBN _ '1234'.
	cart _ Cart forCatalogue: catalogue.
	
	self should: [cart addItem: notExistingISBN amount: 2] raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription ! !

!testRun: #CartTest #test05 stamp: 'lilmonk3y 6/8/2021 20:34:45'!
FAILURE!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:35:46' prior: 50864462!
addItem: anItem amount: anAmount 
	items add: anItem withOccurrences: anAmount ! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:36:21' prior: 50864623!
addItem: anItem 
	
	self addItem: anItem amount: 1! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:36:24' prior: 50864782!
addItem: anItem 

	self addItem: anItem amount: 1! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:36:33' prior: 50864776!
addItem: anItem amount: anAmount 
	(catalogue includes: anItem) ifFalse: [self error: self class isbnNotPresentInCatalogueErrorDescription ].
	
	items add: anItem withOccurrences: anAmount ! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:36:38' prior: 50864792!
addItem: anItem amount: anAmount 
	
	(catalogue includes: anItem) ifFalse: [self error: self class isbnNotPresentInCatalogueErrorDescription ].
	
	items add: anItem withOccurrences: anAmount ! !

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 20:36:41'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 20:36:41'!
PASSED!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:36:41'!
PASSED!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:36:41'!
PASSED!

!testRun: #CartTest #test05 stamp: 'lilmonk3y 6/8/2021 20:36:41'!
PASSED!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:37:16'!
validateItemISBNExistsInCatalogue: anItem

	^ (catalogue includes: anItem) ifFalse: [self error: self class isbnNotPresentInCatalogueErrorDescription ]! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:37:16' prior: 50864801!
addItem: anItem amount: anAmount 
	
	self validateItemISBNExistsInCatalogue: anItem.
	
	items add: anItem withOccurrences: anAmount ! !

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 20:37:19'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 20:37:19'!
PASSED!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:37:19'!
PASSED!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:37:19'!
PASSED!

!testRun: #CartTest #test05 stamp: 'lilmonk3y 6/8/2021 20:37:19'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:38:14' prior: 50864763!
test05
	| cart notExistingISBN |
	notExistingISBN _ '1234'.
	cart _ Cart forCatalogue: catalogue.
	
	self should: [cart addItem: notExistingISBN amount: 2] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription ! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:38:23'!
test06
	| cart notExistingISBN |
	notExistingISBN _ '1234'.
	cart _ Cart forCatalogue: catalogue.
	
	self should: [cart addItem: notExistingISBN amount: 2] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription ! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:39:43' prior: 50864726!
test03
	| cart cartItems isbnOfTDDByExample |
	
	catalogue add: isbnOfTDDByExample.
	cart _ Cart forCatalogue: catalogue.
	
	cart addItem: isbnOfTDDByExample amount: 2.
		
	cartItems _ cart items.
	self assert: 2 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample).! !

!classDefinition: #CartTest category: 'TusLibros.com' stamp: 'lilmonk3y 6/8/2021 20:40:16'!
TestCase subclass: #CartTest
	instanceVariableNames: 'catalogue isbnOfTDDByExample2'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:40:15' prior: 50864710 overrides: 16927572!
setUp
	catalogue _ OrderedCollection new.
	
	isbnOfTDDByExample2 _ '9780321146533'.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:40:59' prior: 50864872!
test03
	| cart cartItems  |
	
	catalogue add: isbnOfTDDByExample2.
	cart _ Cart forCatalogue: catalogue.
	
	cart addItem: isbnOfTDDByExample2 amount: 2.
		
	cartItems _ cart items.
	self assert: 2 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample2).! !

!classDefinition: #CartTest category: 'TusLibros.com' stamp: 'lilmonk3y 6/8/2021 20:41:21'!
TestCase subclass: #CartTest
	instanceVariableNames: 'catalogue isbnOfTDDByExample'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:41:21' prior: 50864893 overrides: 16927572!
setUp
	catalogue _ OrderedCollection new.
	
	isbnOfTDDByExample _ '9780321146533'.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:41:21' prior: 50864899!
test03
	| cart cartItems  |
	
	catalogue add: isbnOfTDDByExample.
	cart _ Cart forCatalogue: catalogue.
	
	cart addItem: isbnOfTDDByExample amount: 2.
		
	cartItems _ cart items.
	self assert: 2 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample).! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:42:08' prior: 50864861!
test06
	| cart |
	
	cart _ Cart forCatalogue: catalogue.
	
	self should: [cart addItem: isbnOfTDDByExample amount: -1] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription ! !

!testRun: #CartTest #test06 stamp: 'lilmonk3y 6/8/2021 20:42:10'!
PASSED!

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 20:42:10'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 20:42:10'!
PASSED!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:42:10'!
PASSED!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:42:10'!
PASSED!

!testRun: #CartTest #test05 stamp: 'lilmonk3y 6/8/2021 20:42:10'!
PASSED!

!testRun: #CartTest #test06 stamp: 'lilmonk3y 6/8/2021 20:42:10'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:42:45' prior: 50864938!
test06
	| cart |
	
	cart _ Cart forCatalogue: catalogue.
	
	self should: [cart addItem: isbnOfTDDByExample amount: -1] 
		raise: Error withMessageText: Cart amountCannotBeANegativeNumberErrorDescription ! !

!testRun: #CartTest #test06 stamp: 'lilmonk3y 6/8/2021 20:42:47'!
ERROR!
!Cart class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:42:55'!
amountCannotBeANegativeNumberErrorDescription
	self shouldBeImplemented.! !
!Cart class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:43:22' prior: 50864976!
amountCannotBeANegativeNumberErrorDescription
	^ 'amount Cannot Be A Negative Number Error Description'! !
!Cart class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:43:30' prior: 50864982!
amountCannotBeANegativeNumberErrorDescription
	^ 'amount Cannot Be A Negative Number'! !

!testRun: #CartTest #test06 stamp: 'lilmonk3y 6/8/2021 20:43:33'!
FAILURE!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:43:49' prior: 50864964!
test06
	| cart |
	catalogue add: isbnOfTDDByExample.
	cart _ Cart forCatalogue: catalogue.
	
	self should: [cart addItem: isbnOfTDDByExample amount: -1] 
		raise: Error withMessageText: Cart amountCannotBeANegativeNumberErrorDescription ! !

!testRun: #CartTest #test06 stamp: 'lilmonk3y 6/8/2021 20:43:51'!
FAILURE!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:46:35' prior: 50864830!
addItem: anItem amount: anAmount 
	
	self validateItemISBNExistsInCatalogue: anItem.
	(anAmount < 0) ifTrue: [self error: self class amountCannotBeANegativeNumberErrorDescription ].
	
	items add: anItem withOccurrences: anAmount ! !

!testRun: #CartTest #test01 stamp: 'lilmonk3y 6/8/2021 20:46:38'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 20:46:38'!
PASSED!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 20:46:38'!
PASSED!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 20:46:38'!
PASSED!

!testRun: #CartTest #test05 stamp: 'lilmonk3y 6/8/2021 20:46:38'!
PASSED!

!testRun: #CartTest #test06 stamp: 'lilmonk3y 6/8/2021 20:46:38'!
PASSED!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:47:18'!
validateAmountIsStrictlyPositive: anAmount

	^ (anAmount < 0) ifTrue: [self error: self class amountCannotBeANegativeNumberErrorDescription ]! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 20:47:18' prior: 50865011!
addItem: anItem amount: anAmount 
	
	self validateItemISBNExistsInCatalogue: anItem.
	self validateAmountIsStrictlyPositive: anAmount.
	
	items add: anItem withOccurrences: anAmount ! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 21:00:20'!
test01OnCartCreationItShouldBeEmpty
	| cart |
	cart _ Cart new.
	
	self assert: 0 equals: cart items size! !

!methodRemoval: CartTest #test01 stamp: 'lilmonk3y 6/8/2021 21:00:20'!
test01
	| cart |
	cart _ Cart new.
	
	self assert: 0 equals: cart items size!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 21:01:17' prior: 50864740!
test02
	| cart cartItems|

	catalogue add: isbnOfTDDByExample .
	cart _ Cart forCatalogue: catalogue.
	
	cart addItem: isbnOfTDDByExample .
	
	cartItems _ cart items.
	self assert: 1 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample ).! !

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 21:01:19'!
PASSED!

!testRun: #CartTest #test01OnCartCreationItShouldBeEmpty stamp: 'lilmonk3y 6/8/2021 21:01:19'!
PASSED!

!testRun: #CartTest #test02 stamp: 'lilmonk3y 6/8/2021 21:01:19'!
PASSED!

!testRun: #CartTest #test03 stamp: 'lilmonk3y 6/8/2021 21:01:19'!
PASSED!

!testRun: #CartTest #test04 stamp: 'lilmonk3y 6/8/2021 21:01:19'!
PASSED!

!testRun: #CartTest #test05 stamp: 'lilmonk3y 6/8/2021 21:01:19'!
PASSED!

!testRun: #CartTest #test06 stamp: 'lilmonk3y 6/8/2021 21:01:19'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 21:01:52'!
test02AddingAnItemModifiesCartSize
	| cart cartItems|

	catalogue add: isbnOfTDDByExample .
	cart _ Cart forCatalogue: catalogue.
	
	cart addItem: isbnOfTDDByExample .
	
	cartItems _ cart items.
	self assert: 1 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample ).! !

!methodRemoval: CartTest #test02 stamp: 'lilmonk3y 6/8/2021 21:01:52'!
test02
	| cart cartItems|

	catalogue add: isbnOfTDDByExample .
	cart _ Cart forCatalogue: catalogue.
	
	cart addItem: isbnOfTDDByExample .
	
	cartItems _ cart items.
	self assert: 1 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample ).!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 21:02:03' prior: 50864926!
test03
	| cart cartItems|
	
	catalogue add: isbnOfTDDByExample.
	cart _ Cart forCatalogue: catalogue.
	
	cart addItem: isbnOfTDDByExample amount: 2.
		
	cartItems _ cart items.
	self assert: 2 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample).! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 21:02:34'!
test03CartAllowsMultiAdd
	| cart cartItems|
	
	catalogue add: isbnOfTDDByExample.
	cart _ Cart forCatalogue: catalogue.
	
	cart addItem: isbnOfTDDByExample amount: 2.
		
	cartItems _ cart items.
	self assert: 2 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample).! !

!methodRemoval: CartTest #test03 stamp: 'lilmonk3y 6/8/2021 21:02:34'!
test03
	| cart cartItems|
	
	catalogue add: isbnOfTDDByExample.
	cart _ Cart forCatalogue: catalogue.
	
	cart addItem: isbnOfTDDByExample amount: 2.
		
	cartItems _ cart items.
	self assert: 2 equals: cartItems size.
	self assert: (cartItems includes: isbnOfTDDByExample).!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 21:03:21'!
test04CannotAddAnItemNotIncludedOnCartCatalogue
	| cart anInvalidISBN |
	cart _ Cart forCatalogue: catalogue.
	anInvalidISBN _ '9780321146537'.

	self should: [cart addItem: anInvalidISBN] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription.
		! !

!methodRemoval: CartTest #test04 stamp: 'lilmonk3y 6/8/2021 21:03:21'!
test04
	| cart anInvalidISBN |
	cart _ Cart forCatalogue: catalogue.
	anInvalidISBN _ '9780321146537'.

	self should: [cart addItem: anInvalidISBN] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription.
		!
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 21:04:05'!
test05CannotAddAnItemNotIncludedOnCatalogueInMultiAdd
	| cart notExistingISBN |
	notExistingISBN _ '1234'.
	cart _ Cart forCatalogue: catalogue.
	
	self should: [cart addItem: notExistingISBN amount: 2] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription ! !

!methodRemoval: CartTest #test05 stamp: 'lilmonk3y 6/8/2021 21:04:05'!
test05
	| cart notExistingISBN |
	notExistingISBN _ '1234'.
	cart _ Cart forCatalogue: catalogue.
	
	self should: [cart addItem: notExistingISBN amount: 2] 
		raise: Error withMessageText: Cart isbnNotPresentInCatalogueErrorDescription !
!CartTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 21:04:56'!
test06CannotAddAnItemWithNegativeAmount
	| cart |
	catalogue add: isbnOfTDDByExample.
	cart _ Cart forCatalogue: catalogue.
	
	self should: [cart addItem: isbnOfTDDByExample amount: -1] 
		raise: Error withMessageText: Cart amountCannotBeANegativeNumberErrorDescription ! !

!methodRemoval: CartTest #test06 stamp: 'lilmonk3y 6/8/2021 21:04:56'!
test06
	| cart |
	catalogue add: isbnOfTDDByExample.
	cart _ Cart forCatalogue: catalogue.
	
	self should: [cart addItem: isbnOfTDDByExample amount: -1] 
		raise: Error withMessageText: Cart amountCannotBeANegativeNumberErrorDescription !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/8/2021 21:05:34' prior: 50864399 overrides: 16896425!
initialize
	items _ Bag new! !

!methodRemoval: Cart #initialize stamp: 'lilmonk3y 6/8/2021 21:05:40'!
initialize
	items _ Bag new!
!Cart methodsFor: 'initialization' stamp: 'lilmonk3y 6/8/2021 21:05:49' prior: 50864523!
initializeWith: aCollection 
	catalogue := aCollection.
	items _ Bag new! !

Object subclass: #Cart
	instanceVariableNames: 'items catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!

!classDefinition: #Cart category: 'TusLibros.com' stamp: 'lilmonk3y 6/8/2021 21:07:32'!
Object subclass: #Cart
	instanceVariableNames: 'items catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!

!testRun: #CartTest #test02AddingAnItemModifiesCartSize stamp: 'lilmonk3y 6/8/2021 21:07:36'!
PASSED!

!testRun: #CartTest #test01OnCartCreationItShouldBeEmpty stamp: 'lilmonk3y 6/8/2021 21:07:36'!
ERROR!

!testRun: #CartTest #test02AddingAnItemModifiesCartSize stamp: 'lilmonk3y 6/8/2021 21:07:36'!
PASSED!

!testRun: #CartTest #test03CartAllowsMultiAdd stamp: 'lilmonk3y 6/8/2021 21:07:36'!
PASSED!

!testRun: #CartTest #test04CannotAddAnItemNotIncludedOnCartCatalogue stamp: 'lilmonk3y 6/8/2021 21:07:36'!
PASSED!

!testRun: #CartTest #test05CannotAddAnItemNotIncludedOnCatalogueInMultiAdd stamp: 'lilmonk3y 6/8/2021 21:07:36'!
PASSED!

!testRun: #CartTest #test06CannotAddAnItemWithNegativeAmount stamp: 'lilmonk3y 6/8/2021 21:07:36'!
PASSED!

!testRun: #CartTest #test01OnCartCreationItShouldBeEmpty stamp: 'lilmonk3y 6/8/2021 21:07:36'!
ERROR!
!CartTest methodsFor: 'testing' stamp: 'lilmonk3y 6/8/2021 21:08:01' prior: 50865052!
test01OnCartCreationItShouldBeEmpty
	| cart |
	cart _ Cart forCatalogue: catalogue .
	
	self assert: 0 equals: cart items size! !

!testRun: #CartTest #test01OnCartCreationItShouldBeEmpty stamp: 'lilmonk3y 6/8/2021 21:08:03'!
PASSED!

!testRun: #CartTest #test02AddingAnItemModifiesCartSize stamp: 'lilmonk3y 6/8/2021 21:08:05'!
PASSED!

!testRun: #CartTest #test01OnCartCreationItShouldBeEmpty stamp: 'lilmonk3y 6/8/2021 21:08:05'!
PASSED!

!testRun: #CartTest #test02AddingAnItemModifiesCartSize stamp: 'lilmonk3y 6/8/2021 21:08:05'!
PASSED!

!testRun: #CartTest #test03CartAllowsMultiAdd stamp: 'lilmonk3y 6/8/2021 21:08:05'!
PASSED!

!testRun: #CartTest #test04CannotAddAnItemNotIncludedOnCartCatalogue stamp: 'lilmonk3y 6/8/2021 21:08:05'!
PASSED!

!testRun: #CartTest #test05CannotAddAnItemNotIncludedOnCatalogueInMultiAdd stamp: 'lilmonk3y 6/8/2021 21:08:05'!
PASSED!

!testRun: #CartTest #test06CannotAddAnItemWithNegativeAmount stamp: 'lilmonk3y 6/8/2021 21:08:05'!
PASSED!

----QUIT----(8 June 2021 21:29:19) CuisUniversity-4532.image priorSource: 17042761!

----STARTUP---- (10 June 2021 20:45:21) as /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/CuisUniversity-4532.image!


----QUIT----(10 June 2021 22:06:20) CuisUniversity-4532.image priorSource: 17076790!

----STARTUP---- (13 June 2021 19:03:53) as /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/CuisUniversity-4532.image!


----QUIT----(13 June 2021 22:05:21) CuisUniversity-4532.image priorSource: 17076998!

----STARTUP---- (14 June 2021 19:50:28) as /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/CuisUniversity-4532.image!


----QUIT----(14 June 2021 21:00:42) CuisUniversity-4532.image priorSource: 17077207!

----STARTUP---- (17 June 2021 17:11:28) as /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/CuisUniversity-4532.image!


!classRemoval: #Cart stamp: 'lilmonk3y 6/17/2021 17:11:46'!
Object subclass: #Cart
	instanceVariableNames: 'items catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!

!classRemoval: #CartTest stamp: 'lilmonk3y 6/17/2021 17:11:46'!
TestCase subclass: #CartTest
	instanceVariableNames: 'catalogue isbnOfTDDByExample'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros.com'!

----End fileIn of /Users/crivera/Documents/Facultad/IS1/Nuestras_soluciones/20-TusLibros/Iteracion-2/TusLibros.st----!

!classRemoval: #MerchantProcessorDown stamp: 'lilmonk3y 6/17/2021 17:12:47'!
MerchantProcessor subclass: #MerchantProcessorDown
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #StoreTestObjectsFactory stamp: 'lilmonk3y 6/17/2021 20:42:22'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #SuccessfulMerchantProcessor stamp: 'lilmonk3y 6/17/2021 20:42:22'!
MerchantProcessor subclass: #SuccessfulMerchantProcessor
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #MerchantProcessorWithoutFunds stamp: 'lilmonk3y 6/17/2021 20:42:23'!
MerchantProcessor subclass: #MerchantProcessorWithoutFunds
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #MerchantProcessor stamp: 'lilmonk3y 6/17/2021 20:42:23'!
Object subclass: #MerchantProcessor
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'lilmonk3y 6/17/2021 20:42:23'!
Object subclass: #CreditCard
	instanceVariableNames: 'creditCardNumber creditCardOwner expirationDate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'lilmonk3y 6/17/2021 20:42:23'!
Object subclass: #Cashier
	instanceVariableNames: 'salesBook clock merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'lilmonk3y 6/17/2021 20:42:23'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCardTest stamp: 'lilmonk3y 6/17/2021 20:42:23'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'lilmonk3y 6/17/2021 20:42:23'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'salesBook expiredMonth expiredYear factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'lilmonk3y 6/17/2021 20:42:23'!
TestCase subclass: #CartTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /Users/crivera/Documents/Facultad/IS1/Enunciados/20-TusLibros/Iteracion2/TusLibros-33.st----!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/17/2021 20:42:49'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/17/2021 20:42:51'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/17/2021 20:42:51'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/17/2021 20:42:51'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/17/2021 20:42:51'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/17/2021 20:42:51'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/17/2021 20:42:51'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/17/2021 20:42:51'!
PASSED!

TestCase subclass: #xxxTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

TestCase subclass: #XXXTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #XXXTest category: 'TusLibros' stamp: 'lilmonk3y 6/17/2021 20:47:50'!
TestCase subclass: #XXXTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/17/2021 20:55:42'!
Object subclass: #Store
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!XXXTest methodsFor: 'no messages' stamp: 'lilmonk3y 6/17/2021 20:55:04'!
test01UserNotValid

	| store userName userPassword |
	userName _ 'a name'.
	userPassword _ 'a password'.
	store _ Store new.
	
 	self should: [store createCartFor: userName with: userPassword] 
		raise: Error - MessageNotUnderstood withMessageText: Store userNotValidErrorDescription.! !

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 20:55:53'!
ERROR!
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 20:56:07'!
userNotValidErrorDescription
	self shouldBeImplemented.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 20:59:01' prior: 50866722!
test01UserNotValid

	| store userName userPassword |
	userName _ 'a name'.
	userPassword _ 'a password'.
	store _ Store new.
	
 	self should: [store createCartFor: userName with: userPassword] 
		raise: Error - MessageNotUnderstood withMessageText: Store userNotValidErrorDescription.! !

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 20:59:01'!
ERROR!
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 20:59:58' prior: 50866737!
userNotValidErrorDescription
	^ 'cannot authenticate user'! !

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 21:00:00'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:00:14'!
createCartFor: aString with: aString2 
	self shouldBeImplemented.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:01:45' prior: 50866765!
createCartFor: aUserName with: aUserPassword 
	^ self error: self class userNotValidErrorDescription ! !

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 21:01:47'!
PASSED!

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 21:01:47'!
PASSED!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:05:10'!
test02CreateCartForValidUser

	| store userName userPassword cartId |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	
 	cartId _ store createCartFor: userName with: userPassword.
	
	self assert: (store listCart: cartId) isEmpty! !

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:05:21'!
ERROR!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:05:38'!
validUserName
	self shouldBeImplemented.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:06:33' prior: 50866798!
validUserName
	^  'Diego no lo dejan tocar la bateria'! !

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:06:34'!
ERROR!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:06:41'!
createStore
	self shouldBeImplemented.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:07:51' prior: 50866811!
createStore
	^ Store authBy: self.! !

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:07:59'!
ERROR!
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:08:07'!
authBy: aXXXTest 
	self shouldBeImplemented.! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:09:01' prior: 50866823!
authBy: aUserAuth 
	^ self new initializeWith: aUserAuth! !

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:09:02'!
ERROR!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/17/2021 21:09:08'!
Object subclass: #Store
	instanceVariableNames: 'userAuth'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/17/2021 21:09:08'!
initializeWith: aUserAuth 
	self shouldBeImplemented.
	userAuth := aUserAuth.! !
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/17/2021 21:09:14' prior: 50866842!
initializeWith: aUserAuth 
	userAuth := aUserAuth.! !

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:09:15'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:12:18' prior: 50866771!
createCartFor: aUserName with: aUserPassword 
	(userAuth authenticate: aUserName using: aUserPassword) ifFalse: [self error: self class userNotValidErrorDescription].
	
	^1! !

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:12:23'!
ERROR!
!XXXTest methodsFor: 'mocking' stamp: 'lilmonk3y 6/17/2021 21:12:38'!
authenticate: aString using: aString2 
	self shouldBeImplemented.! !
!XXXTest methodsFor: 'mocking' stamp: 'lilmonk3y 6/17/2021 21:13:52' prior: 50866867!
authenticate: aUserName using: aUserPassword 
	^ aUserName = self validUserName! !

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:13:53'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:14:02'!
listCart: aSmallInteger 
	self shouldBeImplemented.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:14:38' prior: 50866881!
listCart: aCartId 
	^ OrderedCollection new.! !

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:14:40'!
PASSED!

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 21:14:40'!
ERROR!

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:14:40'!
PASSED!

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 21:14:40'!
ERROR!

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:15:06'!
PASSED!

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 21:15:06'!
ERROR!

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:15:06'!
PASSED!

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 21:15:06'!
ERROR!

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 21:15:27'!
ERROR!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:15:54' prior: 50866742!
test01UserNotValid

	| store userName userPassword |
	userName _ 'a name'.
	userPassword _ 'a password'.
	store _ self createStore .
	
 	self should: [store createCartFor: userName with: userPassword] 
		raise: Error - MessageNotUnderstood withMessageText: Store userNotValidErrorDescription.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:16:08' prior: 50866917!
test01UserNotValid

	| store userName userPassword |
	userName _ 'a name'.
	userPassword _ 'a password'.
	store _ self createStore.
	
 	self should: [store createCartFor: userName with: userPassword] 
		raise: Error - MessageNotUnderstood withMessageText: Store userNotValidErrorDescription.! !

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 21:16:09'!
PASSED!

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:16:13'!
PASSED!

!testRun: #XXXTest #test01UserNotValid stamp: 'lilmonk3y 6/17/2021 21:16:13'!
PASSED!

!testRun: #XXXTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/17/2021 21:16:13'!
PASSED!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:23:56'!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn response |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	cartId _ store createCartFor: userName with: userPassword.
	
	response _ store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ (store listCart: cartId)
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:25:44' prior: 50866954!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn response |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ 2.
	
	response _ store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:26:21' prior: 50866971!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn response |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ 2.
	
	response _ store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: response.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	! !

!testRun: #XXXTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/17/2021 21:26:30'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:26:39'!
addToCart: aSmallInteger bookNumbered: aSmallInteger2 quantity: aSmallInteger3 
	self shouldBeImplemented.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:31:32' prior: 50866988!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn response |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ 2.
	
	"necesitamos modificar el create store para pasarle el catalogo. adems tenemos que hacer al StoreTestObje... una valiable de clase"
	response _ store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: response.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:37:46' prior: 50867015!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn response |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ 2.
	
	"necesitamos modificar el create store para pasarle el catalogo. adems tenemos que hacer al StoreTestObje... una valiable de clase"
	 store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/17/2021 21:37:51' prior: 50867037!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ 2.
	
	"necesitamos modificar el create store para pasarle el catalogo. adems tenemos que hacer al StoreTestObje... una valiable de clase"
	 store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	! !

----QUIT----(17 June 2021 21:44:23) CuisUniversity-4532.image priorSource: 17077416!

----STARTUP---- (20 June 2021 16:33:33) as /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/CuisUniversity-4532.image!


!classRenamed: #XXXTest as: #StoreTest stamp: 'lilmonk3y 6/20/2021 17:32:53'!
Smalltalk renameClassNamed: #XXXTest as: #StoreTest!

!classDefinition: #StoreTest category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 17:35:47'!
TestCase subclass: #StoreTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:35:46' overrides: 16927572!
setUp
	factory _ StoreTestObjectsFactory new.! !

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:37:12'!
ERROR!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:37:17'!
ERROR!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:37:30'!
_test03AddAnItemToACart

	| store userName userPassword cartId books isbn |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ 2.
	
	"necesitamos modificar el create store para pasarle el catalogo. adems tenemos que hacer al StoreTestObje... una valiable de clase"
	 store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/20/2021 17:37:34'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:37:34'!
ERROR!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:37:34'!
ERROR!

!methodRemoval: StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:37:42'!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ 2.
	
	"necesitamos modificar el create store para pasarle el catalogo. adems tenemos que hacer al StoreTestObje... una valiable de clase"
	 store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/20/2021 17:37:46'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:37:59'!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ 2.
	
	"necesitamos modificar el create store para pasarle el catalogo. adems tenemos que hacer al StoreTestObje... una valiable de clase"
	 store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	! !

!methodRemoval: StoreTest #_test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:37:59'!
_test03AddAnItemToACart

	| store userName userPassword cartId books isbn |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ 2.
	
	"necesitamos modificar el create store para pasarle el catalogo. adems tenemos que hacer al StoreTestObje... una valiable de clase"
	 store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:39:25' prior: 50867265!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn |
	userName _ self validUserName.
	userPassword _ 'a password'.
	store _ self createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ factory itemSellByTheStore.
	
	"necesitamos modificar el create store para pasarle el catalogo. adems tenemos que hacer al StoreTestObje... una valiable de clase"
	 store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'lilmonk3y 6/20/2021 17:40:30'!
createStore
	^ Store authBy: self.! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 17:41:38'!
authenticate: aUserName using: aUserPassword 
	^ aUserName = self validUserName! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:41:52' prior: 50866803!
validUserName
	^  'Hernan'! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 17:42:14'!
validUserName
	^  'Hernan'! !

!methodRemoval: StoreTest #validUserName stamp: 'lilmonk3y 6/20/2021 17:42:52'!
validUserName
	^  'Hernan'!

!methodRemoval: StoreTest #createStore stamp: 'lilmonk3y 6/20/2021 17:43:13'!
createStore
	^ Store authBy: self.!

!methodRemoval: StoreTest #authenticate:using: stamp: 'lilmonk3y 6/20/2021 17:43:19'!
authenticate: aUserName using: aUserPassword 
	^ aUserName = self validUserName!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:43:26' prior: 50866930!
test01UserNotValid

	| store userName userPassword |
	userName _ 'a name'.
	userPassword _ 'a password'.
	store _ factory createStore.
	
 	self should: [store createCartFor: userName with: userPassword] 
		raise: Error - MessageNotUnderstood withMessageText: Store userNotValidErrorDescription.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:43:37' prior: 50866783!
test02CreateCartForValidUser

	| store userName userPassword cartId |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	
 	cartId _ store createCartFor: userName with: userPassword.
	
	self assert: (store listCart: cartId) isEmpty! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:43:52' prior: 50867306!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ factory itemSellByTheStore.
	
	"necesitamos modificar el create store para pasarle el catalogo. adems tenemos que hacer al StoreTestObje... una valiable de clase"
	 store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.
	! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:45:13'!
aCatalogue: withCatalogue authBy: aUserAuth 
	^ self new initializeWith: aUserAuth! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:45:13' prior: 50867328!
createStore
	^ Store aCatalogue: nil authBy: self.! !

!methodRemoval: Store class #authBy: stamp: 'lilmonk3y 6/20/2021 17:45:13'!
authBy: aUserAuth 
	^ self new initializeWith: aUserAuth!
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:46:08'!
authBy: aUserAuth withCatalogue: aCatalogue
	^ self new initializeWith: aUserAuth! !

!methodRemoval: Store class #aCatalogue:authBy: stamp: 'lilmonk3y 6/20/2021 17:46:15'!
aCatalogue: withCatalogue authBy: aUserAuth 
	^ self new initializeWith: aUserAuth!
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:46:29' prior: 50867423!
authBy: aUserAuth withCatalogue: aCatalogue
	^ self new initializeWith: aUserAuth catalogue: aCatalogue ! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 17:47:16' prior: 50867414!
createStore
	^ Store authBy: self withCatalogue: nil.! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 17:47:44' prior: 50867442!
createStore
	^ Store authBy: self withCatalogue: self defaultCatalog.! !

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:48:16'!
ERROR!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 17:48:24'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/20/2021 17:48:24'!
initializeWith: aUserAuth catalogue: aCatalogue 
	self shouldBeImplemented.
	userAuth := aUserAuth.
	catalogue := aCatalogue.! !
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/20/2021 17:48:59' prior: 50867463!
initializeWith: aUserAuth catalogue: aCatalogue 
	
	userAuth := aUserAuth.
	catalogue := aCatalogue.! !

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:49:07'!
ERROR!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 17:50:21'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:50:19' prior: 50867008!
addToCart: aSmallInteger bookNumbered: aSmallInteger2 quantity: aSmallInteger3 
	cart _ Cart acceptingItemsOf: catalogue.
	! !

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 17:51:49'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart cartId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:51:47' prior: 50867487!
addToCart: aSmallInteger bookNumbered: aSmallInteger2 quantity: aSmallInteger3 
	cart _ Cart acceptingItemsOf: catalogue.
	cart add:aSmallInteger3 of: aSmallInteger2.
	cartId _ aSmallInteger.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:52:08' prior: 50867502!
addToCart: aCartId bookNumbered: aSmallInteger2 quantity: aSmallInteger3 
	cart _ Cart acceptingItemsOf: catalogue.
	cart add:aSmallInteger3 of: aSmallInteger2.
	cartId _ aCartId.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:52:33' prior: 50867512!
addToCart: aCartId bookNumbered: item quantity: aSmallInteger3 
	cart _ Cart acceptingItemsOf: catalogue.
	cart add:aSmallInteger3 of: item.
	cartId _ aCartId.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:52:56' prior: 50867521!
addToCart: aCartId bookNumbered: item quantity: amountOfItems 
	cart _ Cart acceptingItemsOf: catalogue.
	cart add:amountOfItems of: item.
	cartId _ aCartId.! !

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:52:58'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:53:45' prior: 50867530!
addToCart: aCartId bookNumbered: item quantity: amountOfItems 
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:54:06' prior: 50866856!
createCartFor: aUserName with: aUserPassword 
	(userAuth authenticate: aUserName using: aUserPassword) ifFalse: [self error: self class userNotValidErrorDescription].
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !

Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 17:54:14'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:54:19'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:54:52' prior: 50866886!
listCart: aCartId 
	^ OrderedCollection with: cart .! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:57:51' prior: 50867573!
listCart: aCartId 
	^ cart items.! !

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/20/2021 17:57:57'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:58:06'!
items
	self shouldBeImplemented.
	^items! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:58:12' prior: 50867585!
items
	^items! !

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/20/2021 17:58:16'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/20/2021 17:58:16'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/20/2021 17:58:16'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:58:16'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 17:59:09' prior: 50867385!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ factory itemSellByTheStore.
	
	"necesitamos modificar el create store para pasarle el catalogo. adems tenemos que hacer al StoreTestObje... una valiable de clase"
	 store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: books size equals: 2.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.

	! !

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:59:11'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/20/2021 17:59:11'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/20/2021 17:59:11'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 17:59:11'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 18:13:22'!
test04CheckOutACart

	| store userName userPassword cartId isbn carts |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	carts _ store listPurcheses: userName authBy: userPassword .
	self assert: carts size equals: 1.
	self assert: (carts first items) equals: (store listCart: cartId).

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 18:22:26' prior: 50867640!
test04CheckOutACart

	| store userName userPassword cartId isbn carts |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	store checkOut: cartId on: factory notExpiredCreditCard .
	
	carts _ store listPurcheses: userName authBy: userPassword .
	self assert: carts size equals: 1.
	self assert: (carts first items) equals: (store listCart: cartId).

	! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 18:24:22' prior: 50867448!
createStore
	^ Store authBy: self withCatalogue: self defaultCatalog withMerchantProcessor: self.! !

TestCase subclass: #MerchantProcessorSimulator
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #MerchantProcessorSimulator category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 18:27:36'!
TestCase subclass: #MerchantProcessorSimulator
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #MerchantProcessorSimulator category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 18:27:45'!
TestCase subclass: #MerchantProcessorSimulator
	instanceVariableNames: 'debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!MerchantProcessorSimulator methodsFor: 'no messages' stamp: 'lilmonk3y 6/20/2021 18:27:42'!
debit: anAmount from: aCreditCard 

	^debitBehavior value: anAmount value: aCreditCard ! !
!MerchantProcessorSimulator class methodsFor: 'no messages' stamp: 'lilmonk3y 6/20/2021 18:29:09'!
withDebitBehaviour: aDebitBehaviour
	^ self new initializeBehavingLike: aDebitBehaviour ! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 18:29:41'!
initializeBehavingLike: aDebitBehaviour
	debitBehavior  := aDebitBehaviour ! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 18:32:05' prior: 50867680!
createStore
	^ Store authBy: self withCatalogue: self defaultCatalog withMerchantProcessor: (MerchantProcessorSimulator withDebitBehaviour: [:amount :creditCard | ]).! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 18:32:30' prior: 50867726!
createStore
	^ Store authBy: self withCatalogue: self defaultCatalog withMerchantProcessor: self defaultMerchantProcessor.! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 18:32:58'!
defaultMerchantProcessor
	^ MerchantProcessorSimulator withDebitBehaviour: [:amount :creditCard | ]! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 18:33:10'!
ERROR!
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 18:33:28'!
authBy: aStoreTestObjectsFactory withCatalogue: aDictionary withMerchantProcessor: aMerchantProcessorSimulator 
	self shouldBeImplemented.! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 18:34:15' prior: 50867751!
authBy: aStoreTestObjectsFactory withCatalogue: aDictionary withMerchantProcessor: aMerchantProcessorSimulator 
	| aCatalogue aUserAuth |
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator ! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 18:34:47' prior: 50867759!
authBy: aUserAuth withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator 
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator ! !

!methodRemoval: Store class #authBy:withCatalogue: stamp: 'lilmonk3y 6/20/2021 18:34:51'!
authBy: aUserAuth withCatalogue: aCatalogue
	^ self new initializeWith: aUserAuth catalogue: aCatalogue !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 18:35:24'!
ERROR!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 18:35:33'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/20/2021 18:35:33'!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator 
	self shouldBeImplemented.
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.! !
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/20/2021 18:35:48' prior: 50867796!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator 
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 18:35:49'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 18:35:58'!
checkOut: aSmallInteger on: aCreditCard 
	self shouldBeImplemented.! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 18:36:45'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 18:38:25' prior: 50867818!
checkOut: aSmallInteger on: aCreditCard 
	! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 18:38:31'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 18:38:38'!
listPurcheses: aString authBy: aString2 
	self shouldBeImplemented.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 18:38:55' prior: 50867833!
listPurcheses: aString authBy: aString2 
	^ OrderedCollection with: cart ! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 18:38:57'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/20/2021 18:38:57'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/20/2021 18:38:57'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 18:38:57'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 18:38:57'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 18:39:07'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/20/2021 18:39:07'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/20/2021 18:39:07'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 18:39:07'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 18:39:07'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 18:50:06'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/20/2021 18:50:06'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/20/2021 18:50:06'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 18:50:06'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 18:50:06'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 18:53:29'!
aListOfTest
	'cannot add an item to a cart already checkouted'.
	'cannot check out an already checkouted cart'.
	'more than one cart by user'.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:02:12' prior: 50867888!
aListOfTest
	'cannot add an item to a cart already checkouted'.
	'cannot check out an already checkouted cart'.
	'create cart of a user with an active cart returns the same active cart'.
	'cannot add an item to a cart that was not used in the last 30 minutes'.
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:11:14' prior: 50867896!
aListOfTest
	'cannot add an item to a cart already checkouted'.
	'cannot check out an already checkouted cart'.
	'cannot list purcheses of a user not authenticated'.
	'create cart of a user with an active cart returns the same active cart'.
	'cannot add an item to a cart that was not used in the last 30 minutes'.
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:12:53' prior: 50867913!
aListOfTest
	'cannot add an item to a cart already checkouted'.
	'cannot check out an already checkouted cart'.
	'cannot list purcheses of a user not authenticated'.
	'create cart of a user with an active cart returns the same active cart'.
	'cannot add an item to a cart that was not used in the last 30 minutes'.
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:14:48'!
test05
	"cannot add an item to a cart already checkouted"
	
	| store userName userPassword cartId isbn carts |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	store checkOut: cartId on: factory notExpiredCreditCard .
	
	carts _ store listPurcheses: userName authBy: userPassword .
	self assert: carts size equals: 1.
	self assert: (carts first items) equals: (store listCart: cartId).

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:21:39' prior: 50867978!
test05
	"cannot add an item to a cart already checkouted"
	
	| store userName userPassword cartId isbn carts |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 1] 
		raise: Error 
		withExceptionDo: [:error | 
			self assert: error messageText equals: Store cartAlreadyCheckoutedErrorDescription.
			carts _ store listPurcheses: userName authBy: userPassword .
			self assert: carts size equals: 1.
			self assert: (carts first items) equals: (store listCart: cartId).]
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:23:20' prior: 50868000!
test05
	"cannot add an item to a cart already checkouted"
	
	| store userName userPassword cartId isbn carts |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 1] 
		raise: Error 
		withExceptionDo: [:error || cartItems | 
			self assert: error messageText equals: Store cartAlreadyCheckoutedErrorDescription.
			cartItems _ store listCart: cartId.
			self assert: cartItems size equals: 2.]
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:23:27' prior: 50868029!
test05
	"cannot add an item to a cart already checkouted"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 1] 
		raise: Error 
		withExceptionDo: [:error || cartItems | 
			self assert: error messageText equals: Store cartAlreadyCheckoutedErrorDescription.
			cartItems _ store listCart: cartId.
			self assert: cartItems size equals: 2.]
	

	! !

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/20/2021 19:23:28'!
FAILURE!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 19:24:53'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator checkoutedCart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:24:52' prior: 50867826!
checkOut: aSmallInteger on: aCreditCard 
	checkoutedCart _ cart
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:34:34' prior: 50868092!
checkOut: aSmallInteger on: aCreditCard 
	cart _ nil
	! !

Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 19:34:46'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:37:00'!
cartAlreadyCheckoutedErrorDescription
	^ 'cart does not exists'! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:40:41' prior: 50867541!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/20/2021 19:40:53'!
ERROR!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:43:00' prior: 50868055!
test05
	"cannot add an item to a cart already checkouted"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 1] 
		raise: Error 
		withMessageText: Store cartAlreadyCheckoutedErrorDescription
	

	! !

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/20/2021 19:43:02'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/20/2021 19:43:02'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/20/2021 19:43:02'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/20/2021 19:43:02'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 19:43:02'!
ERROR!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/20/2021 19:43:02'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 19:43:02'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 19:45:32'!
createStoreWithSalesBook: aSalesBook
	^ Store authBy: self withCatalogue: self defaultCatalog withMerchantProcessor: self defaultMerchantProcessor salesbook: aSalesBook .! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 19:46:01' prior: 50867735!
createStore
	^ Store authBy: self withCatalogue: self defaultCatalog withMerchantProcessor: self defaultMerchantProcessor.! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 19:46:22' prior: 50868183!
createStore
	^ Store authBy: self withCatalogue: self defaultCatalog withMerchantProcessor: self defaultMerchantProcessor salesbook: OrderedCollection new.! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:47:05'!
authBy: aUserAuth withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator salesbook: aSalesBook  
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator ! !

!methodRemoval: Store class #authBy:withCatalogue:withMerchantProcessor: stamp: 'lilmonk3y 6/20/2021 19:47:05'!
authBy: aUserAuth withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator 
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:47:33' prior: 50868199!
authBy: aUserAuth withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator salesbook: aSalesBook  
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator ! !
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/20/2021 19:48:32'!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook  
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:48:32' prior: 50868219!
authBy: aUserAuth withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator salesbook: aSalesBook  
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: nil ! !

!methodRemoval: Store #initializeWith:catalogue:on: stamp: 'lilmonk3y 6/20/2021 19:48:32'!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator 
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.!
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:48:40' prior: 50868239!
authBy: aUserAuth withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator salesbook: aSalesBook  
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook ! !

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 19:49:21'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator salesbook'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/20/2021 19:49:19' prior: 50868229!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook  
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.
	salesbook := aSalesBook ! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:49:43' prior: 50867839!
listPurcheses: aString authBy: aString2 
	^ salesbook! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:50:04' prior: 50868289!
listPurcheses: aUserName authBy: aString2 
	^ salesbook! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:50:14' prior: 50868294!
listPurcheses: aUserName authBy: aUserPassword 
	^ salesbook! !
!Cashier methodsFor: 'checkout - private' stamp: 'lilmonk3y 6/20/2021 19:53:15' prior: 50866265!
createSale

	^ Sale of: total details: cart items 
! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 19:55:52' prior: 50868098!
checkOut: aSmallInteger on: aCreditCard 

	| clock |
	Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock registeringOn: salesbook.
	cart _ nil
	! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/20/2021 19:58:26' prior: 50868191!
createStore
	^ Store authBy: self withCatalogue: self defaultCatalog withMerchantProcessor: self defaultMerchantProcessor salesbook: OrderedCollection new withClock: self today.! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 20:00:32'!
authBy: aUserAuth withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator salesbook: aSalesBook withClock: aClock   
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook ! !

!methodRemoval: Store class #authBy:withCatalogue:withMerchantProcessor:salesbook: stamp: 'lilmonk3y 6/20/2021 20:00:32'!
authBy: aUserAuth withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator salesbook: aSalesBook  
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 20:00:45' prior: 50868329!
authBy: aUserAuth withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator salesbook: aSalesBook withClock: aClock   
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook  ! !
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/20/2021 20:01:13'!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: aClock   
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.
	salesbook := aSalesBook ! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 20:01:13' prior: 50868352!
authBy: aUserAuth withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator salesbook: aSalesBook withClock: aClock   
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: nil  ! !

!methodRemoval: Store #initializeWith:catalogue:on:registerOn: stamp: 'lilmonk3y 6/20/2021 20:01:13'!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook  
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.
	salesbook := aSalesBook !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 20:01:21' prior: 50868375!
authBy: aUserAuth withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator salesbook: aSalesBook withClock: aClock   
	^ self new initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: aClock  ! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 20:01:39'!
ERROR!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/20/2021 20:03:41'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator salesbook aclock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/20/2021 20:03:40' prior: 50868363!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: aClock   
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.
	salesbook := aSalesBook.
	aclock := aClock ! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 20:03:53' prior: 50868310!
checkOut: aSmallInteger on: aCreditCard 

	Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook.
	cart _ nil
	! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 20:03:54'!
ERROR!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/20/2021 20:05:27'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/20/2021 20:06:07' prior: 50867659!
test04CheckOutACart

	| store userName userPassword cartId isbn carts |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	store checkOut: cartId on: factory notExpiredCreditCard .
	
	carts _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 size equals: carts size.
	self assert: (carts first items) equals: (store listCart: cartId).

	! !

----SNAPSHOT----(20 June 2021 20:08:31) CuisUniversity-4532.image priorSource: 17133680!

----QUIT----(20 June 2021 20:08:34) CuisUniversity-4532.image priorSource: 17178159!

----STARTUP---- (21 June 2021 10:10:08) as /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/CuisUniversity-4532.image!


!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/21/2021 10:10:57'!
ERROR!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/21/2021 10:10:57'!
ERROR!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/21/2021 10:10:57'!
ERROR!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:10:57'!
ERROR!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 10:10:57'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:11:18'!
ERROR!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:11:57' prior: 50868448!
test04CheckOutACart

	| store userName userPassword cartId isbn carts |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	store checkOut: cartId on: factory notExpiredCreditCard .
	
	carts _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: carts size.
	self assert: (carts first items) equals: (store listCart: cartId).

	! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:11:58'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:13:25' prior: 50868433!
checkOut: aSmallInteger on: aCreditCard 
self halt.
	Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:13:42' prior: 50868570!
checkOut: aSmallInteger on: aCreditCard 

	Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:14:27' prior: 50868579!
checkOut: aSmallInteger on: aCreditCard 
	
	Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:15:48' prior: 50868588!
checkOut: aSmallInteger on: aCreditCard 
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook) checkout.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:16:06' prior: 50868597!
checkOut: aSmallInteger on: aCreditCard 
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook) checkOut.
	cart _ nil
	! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:16:50'!
ERROR!
!Sale class methodsFor: 'instance creation' stamp: 'lilmonk3y 6/21/2021 10:18:05'!
of: aTotal items: aListOfItems 

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal ! !

!methodRemoval: Sale class #of: stamp: 'lilmonk3y 6/21/2021 10:18:05'!
of: aTotal

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal !
!Sale methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 10:18:37'!
initializeTotal: aTotal items: aListOfItems 

	total := aTotal ! !
!Sale class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:18:37' prior: 50868619!
of: aTotal items: aListOfItems 

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal items: nil ! !

!methodRemoval: Sale #initializeTotal: stamp: 'lilmonk3y 6/21/2021 10:18:37'!
initializeTotal: aTotal

	total := aTotal !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:18:59'!
ERROR!
!Cashier methodsFor: 'checkout - private' stamp: 'lilmonk3y 6/21/2021 10:19:44' prior: 50868305!
createSale

	^ Sale of: total items: cart items 
! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:19:46'!
ERROR!
!Sale methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:19:54'!
items
	self shouldBeImplemented.! !

!classDefinition: #Sale category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 10:20:44'!
Object subclass: #Sale
	instanceVariableNames: 'total items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Sale methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 10:20:38' prior: 50868631!
initializeTotal: aTotal items: aListOfItems 

	total := aTotal.
	items := aListOfItems.! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:21:01'!
ERROR!
!Sale methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:21:18' prior: 50868658!
items
	^ items ! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:21:22'!
ERROR!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:22:39' prior: 50868546!
test04CheckOutACart

	| store userName userPassword cartId isbn carts cartItems |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	cartItems _ store listCart: cartId. 
	
	store checkOut: cartId on: factory notExpiredCreditCard .
	
	carts _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: carts size.
	self assert: (carts first items) equals: (cartItems).

	! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:22:43'!
FAILURE!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:22:51'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 10:22:51'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 10:22:51'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 10:22:51'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:22:51'!
FAILURE!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 10:22:51'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:22:51'!
FAILURE!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:22:52'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:22:55'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:23:31' prior: 50868685!
test04CheckOutACart

	| store userName userPassword cartId isbn carts cartItems |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	cartItems _ store listCart: cartId. 
	
	store checkOut: cartId on: factory notExpiredCreditCard .
	
	carts _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: carts size.
	self assert: cartItems equals: (carts first items).

	! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:23:44'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:25:19' prior: 50868607!
checkOut: aSmallInteger on: aCreditCard 
	self halt.
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:25:34' prior: 50868760!
checkOut: aSmallInteger on: aCreditCard 
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Sale class methodsFor: 'instance creation' stamp: 'lilmonk3y 6/21/2021 10:26:44' prior: 50868637!
of: aTotal items: aListOfItems 

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal items: aListOfItems ! !

carts first items!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:28:13'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 10:28:13'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 10:28:13'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 10:28:13'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:28:13'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 10:28:13'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:28:27' prior: 50868735!
test04CheckOutACart

	| store userName userPassword cartId isbn sales cartItems |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	cartItems _ store listCart: cartId. 
	
	store checkOut: cartId on: factory notExpiredCreditCard .
	
	sales _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: sales size.
	self assert: cartItems equals: (sales first items).

	! !

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 10:28:31'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:29:14' prior: 50867945!
aListOfTest
	
	'cannot check out an already checkouted cart'.
	'cannot list purcheses of a user not authenticated'.
	'create cart of a user with an active cart returns the same active cart'.
	'cannot add an item to a cart that was not used in the last 30 minutes'.
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:30:24'!
test06
	"cannot check out an already checkouted cart"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard] 
		raise: Error 
		withMessageText: Store cartAlreadyCheckoutedErrorDescription
	

	! !

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 10:30:27'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:32:09' prior: 50868770!
checkOut: aSmallInteger on: aCreditCard 
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook) checkOut.
	cart _ nil
	! !

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 10:32:11'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 10:32:11'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 10:32:11'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 10:32:11'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:32:11'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 10:32:11'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 10:32:11'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:33:25' prior: 50868892!
aListOfTest
	
	'cannot list purcheses of a user not authenticated'.
	'create cart of a user with an active cart returns the same active cart'.
	'cannot add an item to a cart that was not used in the last 30 minutes'.
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:33:39'!
test07
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard] 
		raise: Error 
		withMessageText: Store cartAlreadyCheckoutedErrorDescription
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:35:03' prior: 50869008!
test07
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	
	self should: [store listPurcheses: userName authBy: userPassword] 
		raise: Error 
		withMessageText: Store userNotValidErrorDescription 
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:35:14' prior: 50869030!
test07
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword  |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	
	self should: [store listPurcheses: userName authBy: userPassword] 
		raise: Error 
		withMessageText: Store userNotValidErrorDescription 
	

	! !

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 10:35:20'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:37:11'!
auth: aUserName with: aUserPassword

	^ (userAuth authenticate: aUserName using: aUserPassword) ifFalse: [self error: self class userNotValidErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:37:11' prior: 50867548!
createCartFor: aUserName with: aUserPassword 
	self auth: aUserName with: aUserPassword.
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:37:52'!
validateUserIsValid: aUserName with: aUserPassword

	^ (userAuth authenticate: aUserName using: aUserPassword) ifFalse: [self error: self class userNotValidErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:37:52' prior: 50869070!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !

!methodRemoval: Store #auth:with: stamp: 'lilmonk3y 6/21/2021 10:37:52'!
auth: aUserName with: aUserPassword

	^ (userAuth authenticate: aUserName using: aUserPassword) ifFalse: [self error: self class userNotValidErrorDescription]!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:37:57' prior: 50869086!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:42:02' prior: 50869102!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	

	cart _ Cart acceptingItemsOf: catalogue.
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:42:14' prior: 50868299!
listPurcheses: aUserName authBy: aUserPassword
	self validateUserIsValid: aUserName with: aUserPassword. 
	^ salesbook! !

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 10:42:23'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:43:00' prior: 50869045!
test07
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword  |
	userName _ factory.
	userPassword _ 'a password'.
	store _ factory createStore.
	
	self should: [store listPurcheses: userName authBy: userPassword] 
		raise: Error 
		withMessageText: Store userNotValidErrorDescription 
	

	! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/21/2021 10:43:43'!
notValidUserName
	^  'Mao'! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/21/2021 10:43:50' prior: 50869142!
notValidUserName
	^  'Mao'! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:44:00' prior: 50869128!
test07
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword  |
	userName _ factory notValidUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	
	self should: [store listPurcheses: userName authBy: userPassword] 
		raise: Error 
		withMessageText: Store userNotValidErrorDescription 
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:44:49' prior: 50867360!
test01UserNotValid

	| store userName userPassword |
	userName _ factory notValidUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	
 	self should: [store createCartFor: userName with: userPassword] 
		raise: Error - MessageNotUnderstood withMessageText: Store userNotValidErrorDescription.! !

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 10:44:54'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 10:44:54'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 10:44:54'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 10:44:54'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:44:54'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 10:44:54'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 10:44:54'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 10:44:54'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:45:21' prior: 50868978!
aListOfTest
	
	'create cart of a user with an active cart returns the same active cart'.
	'cannot add an item to a cart that was not used in the last 30 minutes'.
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:48:16'!
test08
	"create cart of a user with an active cart returns the same active cart"
	
	| store userName userPassword  actualCartId expectedCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	expectedCartId _ store createCartFor: userName with: userPassword.
	
	actualCartId _ store createCartFor: userName with: userPassword.
	
	self assert: expectedCartId equals: actualCartId
	
	

	! !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 10:48:22'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 10:48:22'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 10:48:22'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 10:48:22'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 10:48:22'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 10:48:22'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 10:48:22'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 10:48:22'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 10:48:22'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:49:31' prior: 50869201!
aListOfTest
	
	'cannot add an item to a cart that was not used in the last 30 minutes'.
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !

!classDefinition: #ClockDouble category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 10:56:08'!
Object subclass: #ClockDouble
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:55:57'!
test09
	"cannot add an item to a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 2] 
		raise: Error 
		withMessageText: Store cartAlreadyCheckoutedErrorDescription
	
	

	! !

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 10:56:33'!
ERROR!
!ClockDouble class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:56:41'!
timedAt: aDateAndTime 
	self shouldBeImplemented.! !
!ClockDouble class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:57:19' prior: 50869327!
timedAt: aDateAndTime 
	^ self new initializeTimedAt: aDateAndTime.! !

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 10:57:23'!
ERROR!

!classDefinition: #ClockDouble category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 10:57:29'!
Object subclass: #ClockDouble
	instanceVariableNames: 'dateAndTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!ClockDouble methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 10:57:29'!
initializeTimedAt: aDateAndTime 
	self shouldBeImplemented.
	dateAndTime := aDateAndTime.! !
!ClockDouble methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 10:57:33' prior: 50869348!
initializeTimedAt: aDateAndTime 

	dateAndTime := aDateAndTime.! !

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 10:57:39'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/21/2021 10:58:49'!
createStoreWith: aClock
	^ Store authBy: self withCatalogue: self defaultCatalog withMerchantProcessor: self defaultMerchantProcessor salesbook: OrderedCollection new withClock: aClock.! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/21/2021 10:59:27' prior: 50868320!
createStore
	^ self createStoreWith: self defaultClock.! !

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 10:59:34'!
ERROR!
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:59:49'!
advanceMinutesBy: aSmallInteger 
	self shouldBeImplemented.! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:09:02' prior: 50869379!
advanceMinutesBy: aSmallInteger 
	dateAndTime next: (aSmallInteger * minute)! !

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:09:03'!
ERROR!
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:11:01' prior: 50869385!
advanceMinutesBy: aSmallInteger 
	dateAndTime + (aSmallInteger * minute)! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:12:15' prior: 50869394!
advanceMinutesBy: anAmountOfMinutes 
	dateAndTime + (Duration minutes: anAmountOfMinutes )! !

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:12:17'!
FAILURE!

Object subclass: #CartSession
	instanceVariableNames: 'cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartSession category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 11:15:44'!
Object subclass: #CartSession
	instanceVariableNames: 'cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartSession class methodsFor: 'no messages' stamp: 'lilmonk3y 6/21/2021 11:16:45'!
startSession: aClock for: aCart
	^nil! !
!CartSession class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:18:10' prior: 50869420!
startSession: aClock for: aCart
	^self new initializeClock: aClock cart: aCart! !

!classDefinition: #CartSession category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 11:18:51'!
Object subclass: #CartSession
	instanceVariableNames: 'cart clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartSession methodsFor: 'no messages' stamp: 'lilmonk3y 6/21/2021 11:18:49'!
initializeClock: aClock cart: aCart
	clock := aClock.
	cart:= aCart ! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:21:15'!
test
	| session |
	session _ CartSession startSession: (ClockDouble timedAt: DateAndTime now)  for: Cart new.
	session add: 1.! !

!testRun: #StoreTest #test stamp: 'lilmonk3y 6/21/2021 11:21:34'!
ERROR!

!testRun: #StoreTest #test stamp: 'lilmonk3y 6/21/2021 11:22:15'!
ERROR!

!classDefinition: #CartSession category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 11:30:26'!
Object subclass: #CartSession
	instanceVariableNames: 'cart clock lastUpdate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:30:23' overrides: 16881366!
doesNotUnderstand: aMessage
	lastUpdate + 30 minutes > clock today ifFalse: [^self error: 'fail'].
	lastUpdate _ clock today.
	
	aMessage sendTo: cart! !
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:30:49' prior: 50869438!
initializeClock: aClock cart: aCart
	clock := aClock.
	cart:= aCart.
	lastUpdate := clock today.! !

!methodRemoval: StoreTest #test stamp: 'lilmonk3y 6/21/2021 11:33:15'!
test
	| session |
	session _ CartSession startSession: (ClockDouble timedAt: DateAndTime now)  for: Cart new.
	session add: 1.!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:36:30' prior: 50869303!
test09
	"cannot add an item to a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 2] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 11:40:52'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator salesbook aclock cartLastUse'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:41:22' prior: 50868122!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	cartLastUse + 30 minutes > aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:42:03' prior: 50869110!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cartLastUse  _ aclock today.
	
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:42:08'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:45:06' prior: 50868947!
checkOut: aSmallInteger on: aCreditCard 
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:45:24'!
ERROR!
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:45:35'!
today
	self shouldBeImplemented.! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:45:55' prior: 50869555!
today
	^dateAndTime ! !

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:46:00'!
ERROR!
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:46:10'!
cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	self shouldBeImplemented.! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:46:58' prior: 50869566!
cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	^ 'cart Inactivated Due Not Used For More Than Thirty Minutes'! !

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:46:59'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 11:46:59'!
ERROR!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 11:46:59'!
ERROR!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:46:59'!
ERROR!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 11:46:59'!
ERROR!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 11:46:59'!
ERROR!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 11:46:59'!
ERROR!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 11:46:59'!
ERROR!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 11:46:59'!
ERROR!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:46:59'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 11:47:08'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:47:27'!
defaultClock
	self shouldBeImplemented.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:48:17' prior: 50869609!
defaultClock
	^ ClockDouble timedAt: self today! !

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 11:48:19'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:48:31'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 11:48:31'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 11:48:31'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:48:31'!
ERROR!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 11:48:31'!
ERROR!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 11:48:31'!
ERROR!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 11:48:31'!
ERROR!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 11:48:31'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 11:48:31'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:48:31'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:48:36'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:49:44' prior: 50869515!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	cartLastUse + 30 minutes > aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:50:01' prior: 50869651!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	self halt.
	cartLastUse + 30 minutes > aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:50:19' prior: 50869665!
addToCart: aCartId bookNumbered: item quantity: amountOfItems

	cartLastUse + 30 minutes > aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !

cartLastUse + 30 minutes!

aclock today!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:51:37' prior: 50869679!
addToCart: aCartId bookNumbered: item quantity: amountOfItems

	cartLastUse + 30 minutes < aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:51:38'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 11:51:38'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 11:51:38'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:51:38'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 11:51:38'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 11:51:38'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 11:51:38'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 11:51:38'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 11:51:38'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:51:38'!
FAILURE!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:51:38'!
FAILURE!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:51:45'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 11:51:45'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 11:51:45'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:51:45'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 11:51:45'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 11:51:45'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 11:51:45'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 11:51:45'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 11:51:45'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:51:45'!
FAILURE!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:51:45'!
FAILURE!
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:53:25' prior: 50869400!
advanceMinutesBy: anAmountOfMinutes 
	dateAndTime _ dateAndTime + (Duration minutes: anAmountOfMinutes )! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:53:48' prior: 50869766!
advanceMinutesBy: anAmountOfMinutes 

	dateAndTime _ dateAndTime + (Duration minutes: anAmountOfMinutes )! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:53:54' prior: 50869773!
advanceMinutesBy: anAmountOfMinutes 

	dateAndTime _ dateAndTime + (Duration minutes: anAmountOfMinutes)! !

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:54:00'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 11:54:00'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 11:54:00'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:54:00'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 11:54:01'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 11:54:01'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 11:54:01'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 11:54:01'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 11:54:01'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:54:01'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:54:05'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:54:45' prior: 50869270!
aListOfTest
	
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:55:48'!
test10
	"cannot checkout a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	clock advanceMinutesBy: 35.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard ] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 11:55:51'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:57:33'!
validateCartIsStillValid

	^ cartLastUse + 30 minutes < aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:57:33' prior: 50869694!
addToCart: aCartId bookNumbered: item quantity: amountOfItems

	self validateCartIsStillValid.
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:57:38' prior: 50869947!
addToCart: aCartId bookNumbered: item quantity: amountOfItems

	self validateCartIsStillValid.
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:58:33' prior: 50869541!
checkOut: aSmallInteger on: aCreditCard 
	cart isNil ifTrue: [self error: self class cartAlreadyCheckoutedErrorDescription].
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:59:09'!
validateCartWasNotCheckouted

	^ cart isNil ifTrue: [self error: self class cartAlreadyCheckoutedErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:59:09' prior: 50869967!
checkOut: aSmallInteger on: aCreditCard 
	self validateCartWasNotCheckouted.
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:59:19' prior: 50869986!
checkOut: aSmallInteger on: aCreditCard 
	self validateCartWasNotCheckouted.
	self validateCartIsStillValid.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 11:59:22'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 11:59:22'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 11:59:22'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 11:59:22'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 11:59:22'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 11:59:22'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 11:59:22'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 11:59:22'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 11:59:22'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 11:59:22'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 11:59:22'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:00:10' prior: 50869888!
aListOfTest
	
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'multiple accions on a cart extends its life time'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:01:21'!
test11
	"cannot list the items of a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store listCart: cartId] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:01:36' prior: 50870062!
test11
	"cannot list the items of a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock  |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store listCart: cartId] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 12:01:45'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:01:55' prior: 50870037!
aListOfTest
	
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'multiple accions on a cart extends its life time'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:02:15' prior: 50867578!
listCart: aCartId 
	self validateCartIsStillValid.


	^ cart items.! !

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 12:02:28'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:02:50' prior: 50870107!
aListOfTest
	
	'multiple accions on a cart extends its life time'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:07:54'!
test12
	"multiple accions on a cart extends its life time"
	
	| store userName userPassword  cartId clock  cartItems sales |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 20.
	store listCart: cartId.
	clock advanceMinutesBy: 5.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	cartItems _ store listCart: cartId. 
	clock advanceMinutesBy: 20.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	sales _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: sales size.
	self assert: cartItems equals: (sales first items).
	
	

	! !

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 12:08:10'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:09:04' prior: 50869938!
validateCartIsStillValid
	
	cartLastUse + 30 minutes < aclock today ifTrue: [^self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	cartLastUse _ aclock today.! !

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 12:09:10'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator salesbook clock cartLastUse'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:09:10' prior: 50870218!
validateCartIsStillValid
	
	cartLastUse + 30 minutes < clock today ifTrue: [^self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	cartLastUse _ clock today.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:09:10' prior: 50869997!
checkOut: aSmallInteger on: aCreditCard 
	self validateCartWasNotCheckouted.
	self validateCartIsStillValid.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:09:10' prior: 50869529!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cartLastUse  _ clock today.
	
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:09:10' prior: 50868421!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: aClock   
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.
	salesbook := aSalesBook.
	clock := aClock ! !

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 12:09:15'!
ERROR!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 12:09:16'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 12:09:19'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:18:17' prior: 50870188!
test12
	"multiple accions on a cart extends its life time"
	
	| store userName userPassword  cartId clock  cartItems sales |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 29.
	store listCart: cartId.
	clock advanceMinutesBy: 29.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	cartItems _ store listCart: cartId. 
	clock advanceMinutesBy: 29.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	sales _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: sales size.
	self assert: cartItems equals: (sales first items).
	
	

	! !

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 12:18:19'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:20:45'!
test13
	"creating a cart for a user that already has a cart does not resets its life time"
	
	| store userName userPassword  cartId clock  items |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 29.
	store createCartFor: userName with: userPassword.
	
	items _ store listCart: cartId .
	self assert: items isEmpty.
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:21:49' prior: 50870167!
aListOfTest
	
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:22:28' prior: 50870410!
test13
	"creating a cart for a user that already has a cart does not resets its life time"
	
	| store userName userPassword  cartId clock |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 35.
	
	self should: [store createCartFor: userName with: userPassword] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:22:53' prior: 50870445!
test13
	"creating a cart for a user that already has a cart does not resets its life time"
	
	| store userName userPassword  clock |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 35.
	
	self should: [store createCartFor: userName with: userPassword] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	

	! !

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 12:22:56'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:26:11' prior: 50870466!
test13
	"creating a cart for a user that already has a cart does not resets its life time"
	
	| store userName userPassword  clock cartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 35.
	store createCartFor: userName with: userPassword.
	
	self should: [store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	

	! !

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 12:26:15'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:28:45' prior: 50870259!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cart isNotNil ifTrue: [^ 1].
	
	cartLastUse  _ clock today.
	
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 12:28:51'!
ERROR!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 12:29:25'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:30:03' prior: 50870515!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cart = nil ifTrue: [^ 1].
	
	cartLastUse  _ clock today.
	
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 12:30:10'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:33:31' prior: 50870530!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cart = nil ifTrue: [				
		cart _ Cart acceptingItemsOf: catalogue.
		cartLastUse  _ clock today.].
	
	^1! !

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 12:33:34'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:34:24' prior: 50870430!
aListOfTest
	
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:42:24'!
test14
	"listing operations of a user with more than one checkouted cart must return all of them"
	
	| store userName userPassword  clock cartId newCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	newCartId _ store createCartFor: userName with: userPassword.
	
	self deny: cartId = newCartId
	

	! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 12:42:30'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:49:51'!
_test14
	"listing operations of a user with more than one checkouted cart must return all of them"
	
	| store userName userPassword  clock cartId newCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	newCartId _ store createCartFor: userName with: userPassword.
	
	self deny: cartId = newCartId
	

	! !

!methodRemoval: StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 12:49:51'!
test14
	"listing operations of a user with more than one checkouted cart must return all of them"
	
	| store userName userPassword  clock cartId newCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	newCartId _ store createCartFor: userName with: userPassword.
	
	self deny: cartId = newCartId
	

	!
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:50:43' prior: 50869463 overrides: 16881366!
doesNotUnderstand: aMessage
	lastUpdate + 30 minutes > clock today ifFalse: [^self error: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	lastUpdate _ clock today.
	
	aMessage sendTo: cart! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:52:46' prior: 50870543!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cart = nil ifTrue: [		cart _ CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue).].
	
	^1! !

Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator salesbook clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 12:52:59'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator salesbook clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:53:13' prior: 50869957!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:53:21' prior: 50870247!
checkOut: aSmallInteger on: aCreditCard 
	self validateCartWasNotCheckouted.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:53:36' prior: 50870130!
listCart: aCartId 

	^ cart items.! !

!methodRemoval: Store #validateCartIsStillValid stamp: 'lilmonk3y 6/21/2021 12:53:53'!
validateCartIsStillValid
	
	cartLastUse + 30 minutes < clock today ifTrue: [^self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	cartLastUse _ clock today.!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 12:54:03'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 12:54:03'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 12:54:03'!
ERROR!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 12:54:03'!
ERROR!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 12:54:03'!
ERROR!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 12:54:03'!
ERROR!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 12:54:03'!
ERROR!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 12:54:03'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 12:54:03'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 12:54:03'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 12:54:03'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 12:54:03'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 12:54:03'!
ERROR!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 12:54:04'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 12:54:22'!
ERROR!

(store listCart: cartId)!

(store listCart: cartId) isEmpty!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:56:26' prior: 50867373!
test02CreateCartForValidUser

	| store userName userPassword cartId |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	
 	cartId _ store createCartFor: userName with: userPassword.
	
	self assert: (store listCart: cartId) isEmpty! !

cart items!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:56:55' prior: 50870726!
listCart: aCartId 

	^ cart items.! !
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:58:52' prior: 50870671 overrides: 16881366!
doesNotUnderstand: aMessage
	lastUpdate + 30 minutes > clock today ifFalse: [^self error: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	lastUpdate _ clock today.
	
	self halt.
	aMessage sendTo: cart! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:59:10' prior: 50867590!
items
	self halt.
	^items! !
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:02:03' prior: 50870798 overrides: 16881366!
doesNotUnderstand: aMessage
	lastUpdate + 30 minutes > clock today ifFalse: [^self error: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	lastUpdate _ clock today.
	
	self halt.
	self on: [^aMessage sendTo: cart] do: [super doesNotUnderstand: aMessage ].
	! !
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:05:17' prior: 50870814 overrides: 16881366!
doesNotUnderstand: aMessage
	lastUpdate + 30 minutes > clock today ifFalse: [^self error: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	lastUpdate _ clock today.
	
	[^aMessage sendTo: cart] on: MessageNotUnderstood do: [super doesNotUnderstand: aMessage ].
	! !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 13:05:23'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 13:05:23'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 13:05:23'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 13:05:23'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 13:05:23'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 13:05:23'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 13:05:23'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 13:05:23'!
PASSED!
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:05:38' prior: 50870809!
items

	^items! !

----STARTUP---- (21 June 2021 13:06:04) as /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/CuisUniversity-4532.image!

!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:11:57' prior: 50868448!
test04CheckOutACart

	| store userName userPassword cartId isbn carts |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	store checkOut: cartId on: factory notExpiredCreditCard .
	
	carts _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: carts size.
	self assert: (carts first items) equals: (store listCart: cartId).

	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:13:25' prior: 50868433!
checkOut: aSmallInteger on: aCreditCard 
self halt.
	Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:13:42' prior: 50870888!
checkOut: aSmallInteger on: aCreditCard 

	Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:14:27' prior: 50870897!
checkOut: aSmallInteger on: aCreditCard 
	
	Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:15:48' prior: 50870906!
checkOut: aSmallInteger on: aCreditCard 
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook) checkout.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:16:06' prior: 50870915!
checkOut: aSmallInteger on: aCreditCard 
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Sale class methodsFor: 'instance creation' stamp: 'lilmonk3y 6/21/2021 10:18:05'!
of: aTotal items: aListOfItems 

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal ! !

!methodRemoval: Sale class #of: stamp: 'lilmonk3y 6/21/2021 13:06:14'!
of: aTotal

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal !
!Sale methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 10:18:37'!
initializeTotal: aTotal items: aListOfItems 

	total := aTotal ! !
!Sale class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:18:37' prior: 50870934!
of: aTotal items: aListOfItems 

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal items: nil ! !

!methodRemoval: Sale #initializeTotal: stamp: 'lilmonk3y 6/21/2021 13:06:14'!
initializeTotal: aTotal

	total := aTotal !
!Cashier methodsFor: 'checkout - private' stamp: 'lilmonk3y 6/21/2021 10:19:44' prior: 50868305!
createSale

	^ Sale of: total items: cart items 
! !
!Sale methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:19:54'!
items
	self shouldBeImplemented.! !

!classDefinition: #Sale category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:06:14'!
Object subclass: #Sale
	instanceVariableNames: 'total items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Sale methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 10:20:38' prior: 50870946!
initializeTotal: aTotal items: aListOfItems 

	total := aTotal.
	items := aListOfItems.! !
!Sale methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:21:18' prior: 50870968!
items
	^ items ! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:22:39' prior: 50870867!
test04CheckOutACart

	| store userName userPassword cartId isbn carts cartItems |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	cartItems _ store listCart: cartId. 
	
	store checkOut: cartId on: factory notExpiredCreditCard .
	
	carts _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: carts size.
	self assert: (carts first items) equals: (cartItems).

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:23:31' prior: 50870989!
test04CheckOutACart

	| store userName userPassword cartId isbn carts cartItems |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	cartItems _ store listCart: cartId. 
	
	store checkOut: cartId on: factory notExpiredCreditCard .
	
	carts _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: carts size.
	self assert: cartItems equals: (carts first items).

	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:25:19' prior: 50870925!
checkOut: aSmallInteger on: aCreditCard 
	self halt.
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:25:34' prior: 50871033!
checkOut: aSmallInteger on: aCreditCard 
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Sale class methodsFor: 'instance creation' stamp: 'lilmonk3y 6/21/2021 10:26:44' prior: 50870952!
of: aTotal items: aListOfItems 

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal items: aListOfItems ! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:28:27' prior: 50871011!
test04CheckOutACart

	| store userName userPassword cartId isbn sales cartItems |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	cartItems _ store listCart: cartId. 
	
	store checkOut: cartId on: factory notExpiredCreditCard .
	
	sales _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: sales size.
	self assert: cartItems equals: (sales first items).

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:29:14' prior: 50867945!
aListOfTest
	
	'cannot check out an already checkouted cart'.
	'cannot list purcheses of a user not authenticated'.
	'create cart of a user with an active cart returns the same active cart'.
	'cannot add an item to a cart that was not used in the last 30 minutes'.
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:30:24'!
test06
	"cannot check out an already checkouted cart"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard] 
		raise: Error 
		withMessageText: Store cartAlreadyCheckoutedErrorDescription
	

	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:32:09' prior: 50871043!
checkOut: aSmallInteger on: aCreditCard 
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:33:25' prior: 50871083!
aListOfTest
	
	'cannot list purcheses of a user not authenticated'.
	'create cart of a user with an active cart returns the same active cart'.
	'cannot add an item to a cart that was not used in the last 30 minutes'.
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:33:39'!
test07
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard] 
		raise: Error 
		withMessageText: Store cartAlreadyCheckoutedErrorDescription
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:35:03' prior: 50871177!
test07
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	
	self should: [store listPurcheses: userName authBy: userPassword] 
		raise: Error 
		withMessageText: Store userNotValidErrorDescription 
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:35:14' prior: 50871199!
test07
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword  |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	
	self should: [store listPurcheses: userName authBy: userPassword] 
		raise: Error 
		withMessageText: Store userNotValidErrorDescription 
	

	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:37:11'!
auth: aUserName with: aUserPassword

	^ (userAuth authenticate: aUserName using: aUserPassword) ifFalse: [self error: self class userNotValidErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:37:11' prior: 50867548!
createCartFor: aUserName with: aUserPassword 
	self auth: aUserName with: aUserPassword.
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:37:52'!
validateUserIsValid: aUserName with: aUserPassword

	^ (userAuth authenticate: aUserName using: aUserPassword) ifFalse: [self error: self class userNotValidErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:37:52' prior: 50871237!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !

!methodRemoval: Store #auth:with: stamp: 'lilmonk3y 6/21/2021 13:06:14'!
auth: aUserName with: aUserPassword

	^ (userAuth authenticate: aUserName using: aUserPassword) ifFalse: [self error: self class userNotValidErrorDescription]!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:37:57' prior: 50871253!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.
	
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:42:02' prior: 50871269!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	

	cart _ Cart acceptingItemsOf: catalogue.
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:42:14' prior: 50868299!
listPurcheses: aUserName authBy: aUserPassword
	self validateUserIsValid: aUserName with: aUserPassword. 
	^ salesbook! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:43:00' prior: 50871214!
test07
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword  |
	userName _ factory.
	userPassword _ 'a password'.
	store _ factory createStore.
	
	self should: [store listPurcheses: userName authBy: userPassword] 
		raise: Error 
		withMessageText: Store userNotValidErrorDescription 
	

	! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/21/2021 10:43:43'!
notValidUserName
	^  'Mao'! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/21/2021 10:43:50' prior: 50871306!
notValidUserName
	^  'Mao'! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:44:00' prior: 50871292!
test07
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword  |
	userName _ factory notValidUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	
	self should: [store listPurcheses: userName authBy: userPassword] 
		raise: Error 
		withMessageText: Store userNotValidErrorDescription 
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:44:49' prior: 50867360!
test01UserNotValid

	| store userName userPassword |
	userName _ factory notValidUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	
 	self should: [store createCartFor: userName with: userPassword] 
		raise: Error - MessageNotUnderstood withMessageText: Store userNotValidErrorDescription.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:45:21' prior: 50871147!
aListOfTest
	
	'create cart of a user with an active cart returns the same active cart'.
	'cannot add an item to a cart that was not used in the last 30 minutes'.
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:48:16'!
test08
	"create cart of a user with an active cart returns the same active cart"
	
	| store userName userPassword  actualCartId expectedCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	expectedCartId _ store createCartFor: userName with: userPassword.
	
	actualCartId _ store createCartFor: userName with: userPassword.
	
	self assert: expectedCartId equals: actualCartId
	
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:49:31' prior: 50871343!
aListOfTest
	
	'cannot add an item to a cart that was not used in the last 30 minutes'.
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !

!classDefinition: #ClockDouble category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:06:14'!
Object subclass: #ClockDouble
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:55:57'!
test09
	"cannot add an item to a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 2] 
		raise: Error 
		withMessageText: Store cartAlreadyCheckoutedErrorDescription
	
	

	! !
!ClockDouble class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:56:41'!
timedAt: aDateAndTime 
	self shouldBeImplemented.! !
!ClockDouble class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:57:19' prior: 50871442!
timedAt: aDateAndTime 
	^ self new initializeTimedAt: aDateAndTime.! !

!classDefinition: #ClockDouble category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:06:14'!
Object subclass: #ClockDouble
	instanceVariableNames: 'dateAndTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!ClockDouble methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 10:57:29'!
initializeTimedAt: aDateAndTime 
	self shouldBeImplemented.
	dateAndTime := aDateAndTime.! !
!ClockDouble methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 10:57:33' prior: 50871460!
initializeTimedAt: aDateAndTime 

	dateAndTime := aDateAndTime.! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/21/2021 10:58:49'!
createStoreWith: aClock
	^ Store authBy: self withCatalogue: self defaultCatalog withMerchantProcessor: self defaultMerchantProcessor salesbook: OrderedCollection new withClock: aClock.! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/21/2021 10:59:27' prior: 50868320!
createStore
	^ self createStoreWith: self defaultClock.! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 10:59:49'!
advanceMinutesBy: aSmallInteger 
	self shouldBeImplemented.! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:09:02' prior: 50871486!
advanceMinutesBy: aSmallInteger 
	dateAndTime next: (aSmallInteger * minute)! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:11:01' prior: 50871492!
advanceMinutesBy: aSmallInteger 
	dateAndTime + (aSmallInteger * minute)! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:12:15' prior: 50871498!
advanceMinutesBy: anAmountOfMinutes 
	dateAndTime + (Duration minutes: anAmountOfMinutes )! !

!classDefinition: #CartSession category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:06:14'!
Object subclass: #CartSession
	instanceVariableNames: 'cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartSession category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:06:14'!
Object subclass: #CartSession
	instanceVariableNames: 'cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartSession class methodsFor: 'no messages' stamp: 'lilmonk3y 6/21/2021 11:16:45'!
startSession: aClock for: aCart
	^nil! !
!CartSession class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:18:10' prior: 50871524!
startSession: aClock for: aCart
	^self new initializeClock: aClock cart: aCart! !

!classDefinition: #CartSession category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:06:14'!
Object subclass: #CartSession
	instanceVariableNames: 'cart clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartSession methodsFor: 'no messages' stamp: 'lilmonk3y 6/21/2021 11:18:49'!
initializeClock: aClock cart: aCart
	clock := aClock.
	cart:= aCart ! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:21:15'!
test
	| session |
	session _ CartSession startSession: (ClockDouble timedAt: DateAndTime now)  for: Cart new.
	session add: 1.! !

!classDefinition: #CartSession category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:06:14'!
Object subclass: #CartSession
	instanceVariableNames: 'cart clock lastUpdate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:30:23' overrides: 16881366!
doesNotUnderstand: aMessage
	lastUpdate + 30 minutes > clock today ifFalse: [^self error: 'fail'].
	lastUpdate _ clock today.
	
	aMessage sendTo: cart! !
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:30:49' prior: 50871542!
initializeClock: aClock cart: aCart
	clock := aClock.
	cart:= aCart.
	lastUpdate := clock today.! !

!methodRemoval: StoreTest #test stamp: 'lilmonk3y 6/21/2021 13:06:14'!
test
	| session |
	session _ CartSession startSession: (ClockDouble timedAt: DateAndTime now)  for: Cart new.
	session add: 1.!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:36:30' prior: 50871421!
test09
	"cannot add an item to a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 2] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:06:14'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator salesbook aclock cartLastUse'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:41:22' prior: 50868122!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	cartLastUse + 30 minutes > aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:42:03' prior: 50871277!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cartLastUse  _ aclock today.
	
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:45:06' prior: 50871135!
checkOut: aSmallInteger on: aCreditCard 
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:45:35'!
today
	self shouldBeImplemented.! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:45:55' prior: 50871649!
today
	^dateAndTime ! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:46:10'!
cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	self shouldBeImplemented.! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:46:58' prior: 50871658!
cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	^ 'cart Inactivated Due Not Used For More Than Thirty Minutes'! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:47:27'!
defaultClock
	self shouldBeImplemented.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:48:17' prior: 50871673!
defaultClock
	^ ClockDouble timedAt: self today! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:49:44' prior: 50871614!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	cartLastUse + 30 minutes > aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:50:01' prior: 50871683!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	self halt.
	cartLastUse + 30 minutes > aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:50:19' prior: 50871697!
addToCart: aCartId bookNumbered: item quantity: amountOfItems

	cartLastUse + 30 minutes > aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:51:37' prior: 50871711!
addToCart: aCartId bookNumbered: item quantity: amountOfItems

	cartLastUse + 30 minutes < aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:53:25' prior: 50871504!
advanceMinutesBy: anAmountOfMinutes 
	dateAndTime _ dateAndTime + (Duration minutes: anAmountOfMinutes )! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:53:48' prior: 50871739!
advanceMinutesBy: anAmountOfMinutes 

	dateAndTime _ dateAndTime + (Duration minutes: anAmountOfMinutes )! !
!ClockDouble methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:53:54' prior: 50871746!
advanceMinutesBy: anAmountOfMinutes 

	dateAndTime _ dateAndTime + (Duration minutes: anAmountOfMinutes)! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:54:45' prior: 50871388!
aListOfTest
	
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:55:48'!
test10
	"cannot checkout a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	clock advanceMinutesBy: 35.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard ] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:57:33'!
validateCartIsStillValid

	^ cartLastUse + 30 minutes < aclock today ifTrue: [self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:57:33' prior: 50871725!
addToCart: aCartId bookNumbered: item quantity: amountOfItems

	self validateCartIsStillValid.
	
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:57:38' prior: 50871817!
addToCart: aCartId bookNumbered: item quantity: amountOfItems

	self validateCartIsStillValid.
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:58:33' prior: 50871637!
checkOut: aSmallInteger on: aCreditCard 
	cart isNil ifTrue: [self error: self class cartAlreadyCheckoutedErrorDescription].
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:59:09'!
validateCartWasNotCheckouted

	^ cart isNil ifTrue: [self error: self class cartAlreadyCheckoutedErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:59:09' prior: 50871837!
checkOut: aSmallInteger on: aCreditCard 
	self validateCartWasNotCheckouted.
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 11:59:19' prior: 50871856!
checkOut: aSmallInteger on: aCreditCard 
	self validateCartWasNotCheckouted.
	self validateCartIsStillValid.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: aclock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:00:10' prior: 50871760!
aListOfTest
	
	'cannot checkout a cart that was not used in the last 30 minutes'.
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'multiple accions on a cart extends its life time'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:01:21'!
test11
	"cannot list the items of a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store listCart: cartId] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:01:36' prior: 50871904!
test11
	"cannot list the items of a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock  |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store listCart: cartId] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:01:55' prior: 50871879!
aListOfTest
	
	'cannot list the items of a cart that was not used in the last 30 minutes'.
	'multiple accions on a cart extends its life time'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:02:15' prior: 50867578!
listCart: aCartId 
	self validateCartIsStillValid.


	^ cart items.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:02:50' prior: 50871946!
aListOfTest
	
	'multiple accions on a cart extends its life time'.
	'checkout of a cart allows cart to be listed forever'.
	'adding an item to a cart resets its life time'.
	'listing a cart resets its life time'.
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:07:54'!
test12
	"multiple accions on a cart extends its life time"
	
	| store userName userPassword  cartId clock  cartItems sales |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 20.
	store listCart: cartId.
	clock advanceMinutesBy: 5.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	cartItems _ store listCart: cartId. 
	clock advanceMinutesBy: 20.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	sales _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: sales size.
	self assert: cartItems equals: (sales first items).
	
	

	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:09:04' prior: 50871808!
validateCartIsStillValid
	
	cartLastUse + 30 minutes < aclock today ifTrue: [^self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	cartLastUse _ aclock today.! !

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:06:14'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator salesbook clock cartLastUse'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:09:10' prior: 50872024!
validateCartIsStillValid
	
	cartLastUse + 30 minutes < clock today ifTrue: [^self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	cartLastUse _ clock today.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:09:10' prior: 50871867!
checkOut: aSmallInteger on: aCreditCard 
	self validateCartWasNotCheckouted.
	self validateCartIsStillValid.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:09:10' prior: 50871628!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cartLastUse  _ clock today.
	
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:09:10' prior: 50868421!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: aClock   
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.
	salesbook := aSalesBook.
	clock := aClock ! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:18:17' prior: 50871996!
test12
	"multiple accions on a cart extends its life time"
	
	| store userName userPassword  cartId clock  cartItems sales |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 29.
	store listCart: cartId.
	clock advanceMinutesBy: 29.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	cartItems _ store listCart: cartId. 
	clock advanceMinutesBy: 29.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	sales _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: sales size.
	self assert: cartItems equals: (sales first items).
	
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:20:45'!
test13
	"creating a cart for a user that already has a cart does not resets its life time"
	
	| store userName userPassword  cartId clock  items |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 29.
	store createCartFor: userName with: userPassword.
	
	items _ store listCart: cartId .
	self assert: items isEmpty.
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:21:49' prior: 50871975!
aListOfTest
	
	'creating a cart for a user that already has a cart does not resets its life time'.
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:22:28' prior: 50872114!
test13
	"creating a cart for a user that already has a cart does not resets its life time"
	
	| store userName userPassword  cartId clock |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 35.
	
	self should: [store createCartFor: userName with: userPassword] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:22:53' prior: 50872149!
test13
	"creating a cart for a user that already has a cart does not resets its life time"
	
	| store userName userPassword  clock |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 35.
	
	self should: [store createCartFor: userName with: userPassword] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:26:11' prior: 50872170!
test13
	"creating a cart for a user that already has a cart does not resets its life time"
	
	| store userName userPassword  clock cartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 35.
	store createCartFor: userName with: userPassword.
	
	self should: [store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	

	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:28:45' prior: 50872065!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cart isNotNil ifTrue: [^ 1].
	
	cartLastUse  _ clock today.
	
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:30:03' prior: 50872215!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cart = nil ifTrue: [^ 1].
	
	cartLastUse  _ clock today.
	
	cart _ Cart acceptingItemsOf: catalogue.
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:33:31' prior: 50872225!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cart = nil ifTrue: [				
		cart _ Cart acceptingItemsOf: catalogue.
		cartLastUse  _ clock today.].
	
	^1! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:34:24' prior: 50872134!
aListOfTest
	
	'listing operations of a user with more than one checkouted cart must return all of them'.
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:42:24'!
test14
	"listing operations of a user with more than one checkouted cart must return all of them"
	
	| store userName userPassword  clock cartId newCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	newCartId _ store createCartFor: userName with: userPassword.
	
	self deny: cartId = newCartId
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:49:51'!
_test14
	"listing operations of a user with more than one checkouted cart must return all of them"
	
	| store userName userPassword  clock cartId newCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	newCartId _ store createCartFor: userName with: userPassword.
	
	self deny: cartId = newCartId
	

	! !

!methodRemoval: StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:06:15'!
test14
	"listing operations of a user with more than one checkouted cart must return all of them"
	
	| store userName userPassword  clock cartId newCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	newCartId _ store createCartFor: userName with: userPassword.
	
	self deny: cartId = newCartId
	

	!
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:50:43' prior: 50871562 overrides: 16881366!
doesNotUnderstand: aMessage
	lastUpdate + 30 minutes > clock today ifFalse: [^self error: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	lastUpdate _ clock today.
	
	aMessage sendTo: cart! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:52:46' prior: 50872235!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cart = nil ifTrue: [		cart _ CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue).].
	
	^1! !

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:06:15'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator salesbook clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:06:15'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cart merchantProcessorSimulator salesbook clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:53:13' prior: 50871827!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	
	cart isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cart add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:53:21' prior: 50872053!
checkOut: aSmallInteger on: aCreditCard 
	self validateCartWasNotCheckouted.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	cart _ nil
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:53:36' prior: 50871969!
listCart: aCartId 

	^ cart items.! !

!methodRemoval: Store #validateCartIsStillValid stamp: 'lilmonk3y 6/21/2021 13:06:15'!
validateCartIsStillValid
	
	cartLastUse + 30 minutes < clock today ifTrue: [^self error: self class cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	
	cartLastUse _ clock today.!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:56:26' prior: 50867373!
test02CreateCartForValidUser

	| store userName userPassword cartId |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	
 	cartId _ store createCartFor: userName with: userPassword.
	
	self assert: (store listCart: cartId) isEmpty! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:56:55' prior: 50872382!
listCart: aCartId 

	^ cart items.! !
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:58:52' prior: 50872324 overrides: 16881366!
doesNotUnderstand: aMessage
	lastUpdate + 30 minutes > clock today ifFalse: [^self error: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	lastUpdate _ clock today.
	
	self halt.
	aMessage sendTo: cart! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 12:59:10' prior: 50867590!
items
	self halt.
	^items! !
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:02:03' prior: 50872413 overrides: 16881366!
doesNotUnderstand: aMessage
	lastUpdate + 30 minutes > clock today ifFalse: [^self error: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	lastUpdate _ clock today.
	
	self halt.
	self on: [^aMessage sendTo: cart] do: [super doesNotUnderstand: aMessage ].
	! !
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:05:17' prior: 50872429 overrides: 16881366!
doesNotUnderstand: aMessage
	lastUpdate + 30 minutes > clock today ifFalse: [^self error: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	lastUpdate _ clock today.
	
	[^aMessage sendTo: cart] on: MessageNotUnderstood do: [super doesNotUnderstand: aMessage ].
	! !
!Cart methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:05:38' prior: 50872424!
items

	^items! !

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 13:07:01'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 13:07:05'!
PASSED!

!methodRemoval: Store #initializeWith: stamp: 'lilmonk3y 6/21/2021 13:09:01'!
initializeWith: aUserAuth 
	userAuth := aUserAuth.!

!methodRemoval: Store #initializeWith:catalogue: stamp: 'lilmonk3y 6/21/2021 13:09:04'!
initializeWith: aUserAuth catalogue: aCatalogue 
	
	userAuth := aUserAuth.
	catalogue := aCatalogue.!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 13:09:13'!
PASSED!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:10:06'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cartSession merchantProcessorSimulator salesbook clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:10:06' prior: 50872334!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cartSession = nil ifTrue: [		cartSession _ CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue).].
	
	^1! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:10:06' prior: 50871849!
validateCartWasNotCheckouted

	^ cartSession isNil ifTrue: [self error: self class cartAlreadyCheckoutedErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:10:06' prior: 50872408!
listCart: aCartId 

	^ cartSession items.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:10:06' prior: 50872362!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	
	cartSession isNil ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cartSession add:amountOfItems of: item.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:10:06' prior: 50872371!
checkOut: aSmallInteger on: aCreditCard 
	self validateCartWasNotCheckouted.
	
	(Cashier toCheckout: cartSession charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	cartSession _ nil
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:10:38'!
test14
	"listing operations of a user with more than one checkouted cart must return all of them"
	
	| store userName userPassword  clock cartId newCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	newCartId _ store createCartFor: userName with: userPassword.
	
	self deny: cartId = newCartId
	

	! !

!methodRemoval: StoreTest #_test14 stamp: 'lilmonk3y 6/21/2021 13:10:42'!
_test14
	"listing operations of a user with more than one checkouted cart must return all of them"
	
	| store userName userPassword  clock cartId newCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	newCartId _ store createCartFor: userName with: userPassword.
	
	self deny: cartId = newCartId
	

	!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:11:23'!
FAILURE!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:13:37' prior: 50872635!
createCartFor: aUserName with: aUserPassword 
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	cartSession = nil ifTrue: [		cartSession _ CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue).].
	
	^self newCartId! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:13:40'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:13:47'!
newCartId
	self shouldBeImplemented.! !

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:15:03'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cartSession merchantProcessorSimulator salesbook clock nextId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:15:02' prior: 50872738!
newCartId
	nextId _ nextId + 1.
	^nextId
	! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:15:08'!
ERROR!
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 13:15:31' prior: 50872074!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: aClock   
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.
	salesbook := aSalesBook.
	clock := aClock.
	
	nextId := 0! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
FAILURE!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 13:15:35'!
FAILURE!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:23:19'!
Object subclass: #Store
	instanceVariableNames: 'userAuth catalogue cartSession merchantProcessorSimulator salesbook clock nextId carts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartForUser category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:23:27'!
Object subclass: #CartForUser
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:23:10' prior: 50872725!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	(self hasCartForUser: aUserName) ifTrue: [		^ self cartForUser: aUserName].
	
	id _ self newCartId.
	carts add: (CartForUser cart: (CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue)) of: aUserName with: id). 
	^id! !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 13:23:32'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:23:41'!
hasCartForUser: aString 
	self shouldBeImplemented.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:28:49' prior: 50872844!
hasCartForUser: aString 
	^carts anySatisfy: [:cart | cart isForUser: aString ] ! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:29:05' prior: 50872849!
hasCartForUser: aUserName 
	^carts anySatisfy: [:cart | cart isForUser: aUserName ] ! !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 13:29:06'!
ERROR!
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 13:29:37' prior: 50872759!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: aClock   
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.
	salesbook := aSalesBook.
	clock := aClock.
	
	carts := OrderedCollection new.
	nextId := 0! !

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 13:29:50'!
ERROR!
!CartForUser class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:30:07'!
cart: aCartSession of: aString with: aSmallInteger 
	self shouldBeImplemented.! !
!CartForUser class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:31:03' prior: 50872879!
cart: aCartSession of: aUserName with: anId 
	^ self new initializeWith: aCartSession of: aUserName with: anId! !

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 13:31:06'!
ERROR!

!classDefinition: #CartForUser category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:31:11'!
Object subclass: #CartForUser
	instanceVariableNames: 'cartSession'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartForUser category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:31:12'!
Object subclass: #CartForUser
	instanceVariableNames: 'cartSession userName'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartForUser category: 'TusLibros' stamp: 'lilmonk3y 6/21/2021 13:31:12'!
Object subclass: #CartForUser
	instanceVariableNames: 'cartSession userName id'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartForUser methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 13:31:12'!
initializeWith: aCartSession of: aUserName with: anId 
	self shouldBeImplemented.
	cartSession := aCartSession.
	userName := aUserName.
	id := anId.! !
!CartForUser methodsFor: 'initialization' stamp: 'lilmonk3y 6/21/2021 13:31:17' prior: 50872916!
initializeWith: aCartSession of: aUserName with: anId 
	
	cartSession := aCartSession.
	userName := aUserName.
	id := anId.! !

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 13:31:19'!
ERROR!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:31:43'!
ERROR!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:34:47' prior: 50872658!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	
	(carts select: [:cart | cart isForId: aCartId]) ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cartSession add:amountOfItems of: item.! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:35:15' prior: 50872936!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	
	| cartForId |
	cartForId _ carts select: [:cart | cart isForId: aCartId].
	(cartForId) ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	cartSession add:amountOfItems of: item.! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:35:49' prior: 50872947!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	
	| cartForId |
	cartForId _ carts select: [:cart | cart isForId: aCartId].
	(cartForId isNil) ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	
	cartForId add:amountOfItems of: item.! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:36:12'!
getCartForId: aCartId

	^ carts select: [:cart | cart isForId: aCartId]! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:36:12' prior: 50872959!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	
	| cartForId |
	cartForId _ self getCartForId: aCartId.
	(cartForId isNil) ifTrue: [^ self error: self class cartAlreadyCheckoutedErrorDescription].
	
	cartForId add:amountOfItems of: item.! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:36:16'!
ERROR!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:36:22'!
ERROR!
!CartForUser methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:36:28'!
isForId: aSmallInteger 
	self shouldBeImplemented.! !
!CartForUser methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:36:55' prior: 50872992!
isForId: aCartId 
	^ id = aCartId ! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:36:56'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:39:59' prior: 50872970!
getCartForId: aCartId

	^ carts detect: [:cart | cart isForId: aCartId] ifNone: [nil]! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:40:02'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:41:26' prior: 50873004!
getCartForId: aCartId

	^ (carts detect: [:cart | cart isForId: aCartId]) cart! !
!CartForUser methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:41:43'!
cart
	^ cartSession ! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:41:48'!
ERROR!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:42:20' prior: 50872668!
checkOut: cartId on: aCreditCard 
	self validateCartWasNotCheckouted.
	
	(Cashier toCheckout: cartSession charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	cartSession _ nil
	! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:43:40' prior: 50873025!
checkOut: cartId on: aCreditCard 
	| cart |
	cart _ self getCartForId: cartId.
	self validateCartWasNotCheckouted.
	
	(Cashier toCheckout: cartSession charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	cartSession _ nil
	! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:45:04' prior: 50873036!
checkOut: cartId on: aCreditCard 
	| cart |
	cart _ self validateCartWasNotCheckouted.
	
	(Cashier toCheckout: cartSession charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	cartSession _ nil
	! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:45:12' prior: 50873048!
checkOut: cartId on: aCreditCard 
	| cart |
	cart _ self validateCartWasNotCheckouted.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	cartSession _ nil
	! !
!Store methodsFor: 'validations' stamp: 'lilmonk3y 6/21/2021 13:45:37'!
validateCartWasNotCheckouted: cartId

	^ cartSession isNil ifTrue: [self error: self class cartAlreadyCheckoutedErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:45:37' prior: 50873059!
checkOut: cartId on: aCreditCard 
	| cart |
	cart _ self validateCartWasNotCheckouted: nil.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	cartSession _ nil
	! !

!methodRemoval: Store #validateCartWasNotCheckouted stamp: 'lilmonk3y 6/21/2021 13:45:37'!
validateCartWasNotCheckouted

	^ cartSession isNil ifTrue: [self error: self class cartAlreadyCheckoutedErrorDescription]!
!Store methodsFor: 'validations' stamp: 'lilmonk3y 6/21/2021 13:47:16' prior: 50873070!
validateCartWasNotCheckouted: cartId
	^[self getCartForId: cartId] on: Error do: [self error: self class cartAlreadyCheckoutedErrorDescription]! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:47:26'!
ERROR!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:48:43'!
ERROR!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:49:30' prior: 50873078!
checkOut: cartId on: aCreditCard 
	| cart |
	cart _ self validateCartWasNotCheckouted: cartId.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	cartSession _ nil
	! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:49:32'!
ERROR!
!CartForUser methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:49:46'!
isForUser: aString 
	self shouldBeImplemented.! !
!CartForUser methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:50:10' prior: 50873123!
isForUser: aUserName 
	^ userName  = aUserName ! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:50:11'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:51:00'!
cartForUser: aString 
	self shouldBeImplemented.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:51:43' prior: 50873135!
cartForUser: aString 
	^ carts detect: [:cart | cart isForUser: aString]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:51:52' prior: 50873140!
cartForUser: aUserName 
	^ carts detect: [:cart | cart isForUser: aUserName]! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:51:53'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/21/2021 13:51:53'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:51:53'!
ERROR!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 13:51:53'!
ERROR!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 13:51:53'!
ERROR!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 13:51:53'!
FAILURE!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/21/2021 13:51:53'!
FAILURE!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/21/2021 13:51:53'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/21/2021 13:51:53'!
FAILURE!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/21/2021 13:51:53'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/21/2021 13:51:53'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/21/2021 13:51:53'!
FAILURE!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 13:51:53'!
ERROR!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/21/2021 13:51:53'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/21/2021 13:51:53'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:52:05'!
ERROR!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:52:50' prior: 50872653!
listCart: aCartId 

	^ (carts getCartForId: aCartId) items.! !

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:52:52'!
ERROR!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:54:05' prior: 50873193!
listCart: aCartId 

	^ (self getCartForId: aCartId) items.! !

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:54:09'!
ERROR!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:54:11'!
ERROR!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:54:12'!
ERROR!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/21/2021 13:54:24'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/21/2021 13:54:27'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/21/2021 13:54:28'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/21/2021 13:54:29'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 13:54:29'!
FAILURE!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/21/2021 13:58:00' prior: 50873109!
checkOut: cartId on: aCreditCard 
	| cart |
	cart _ self validateCartWasNotCheckouted: cartId.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	carts remove: (self getCartXXX: cartId)
	! !

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 13:58:13'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:58:23'!
getCartXXX: aSmallInteger 
	self shouldBeImplemented.! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:59:17' prior: 50873243!
getCartXXX: aSmallInteger 
	^ carts detect: [:cart | cart isForId: aSmallInteger]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 13:59:31' prior: 50873248!
getCartXXX: aCartId 
	^ carts detect: [:cart | cart isForId: aCartId]! !

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 13:59:34'!
FAILURE!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/21/2021 13:59:59'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/21/2021 14:01:15' prior: 50872245!
aListOfTest
	
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	! !

----SNAPSHOT----(21 June 2021 14:02:44) CuisUniversity-4532.image priorSource: 17178249!

----QUIT----(21 June 2021 14:02:49) CuisUniversity-4532.image priorSource: 17331928!

----STARTUP---- (22 June 2021 18:40:47) as /Users/crivera/Documents/Facultad/IS1/Cuis/macos64/CuisUniversity-4532.image!


!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 18:45:26'!
FAILURE!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 18:45:26'!
FAILURE!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 18:45:26'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 18:45:31'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:46:10' prior: 50868134!
test05
	"cannot add an item to a cart already checkouted"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	self halt.
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 1] 
		raise: Error 
		withMessageText: Store cartAlreadyCheckoutedErrorDescription
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:46:29' prior: 50873324!
test05
	"cannot add an item to a cart already checkouted"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 1] 
		raise: Error 
		withMessageText: Store cartAlreadyCheckoutedErrorDescription
	

	! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:50:00'!
thereIsNotAnActiveCartForTheUserErrorDescription
	^ 'cart does not exists'! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:50:00' prior: 50873096!
validateCartWasNotCheckouted: cartId
	^[self getCartForId: cartId] on: Error do: [self error: self class thereIsNotAnActiveCartForTheUserErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:50:00' prior: 50872976!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	
	| cartForId |
	cartForId _ self getCartForId: aCartId.
	(cartForId isNil) ifTrue: [^ self error: self class thereIsNotAnActiveCartForTheUserErrorDescription].
	
	cartForId add:amountOfItems of: item.! !

!methodRemoval: Store class #cartAlreadyCheckoutedErrorDescription stamp: 'lilmonk3y 6/22/2021 18:50:00'!
cartAlreadyCheckoutedErrorDescription
	^ 'cart does not exists'!
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:50:24' prior: 50873367!
thereIsNotAnActiveCartForTheUserErrorDescription
	^ 'cart not found'! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:52:25' prior: 50873013!
getCartForId: aCartId

	^ (carts detect: [:cart | cart isForId: aCartId] ifNone: [self error: self class thereIsNotAnActiveCartForTheUserErrorDescription]) cart! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:53:19' prior: 50873254!
getCartXXX: aCartId 
	^ carts detect: [:cart | cart isForId: aCartId] ifNone: [self error: self class thereIsNotAnActiveCartForTheUserErrorDescription]! !

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 18:54:08'!
ERROR!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 18:54:08'!
ERROR!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 18:54:08'!
FAILURE!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 18:54:08'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:54:16' prior: 50873346!
test05
	"cannot add an item to a cart already checkouted"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 1] 
		raise: Error 
		withMessageText: Store thereIsNotAnActiveCartForTheUserErrorDescription
	

	! !

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 18:54:17'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:54:21' prior: 50871114!
test06
	"cannot check out an already checkouted cart"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard] 
		raise: Error 
		withMessageText: Store thereIsNotAnActiveCartForTheUserErrorDescription
	

	! !

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 18:54:22'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 18:54:31'!
FAILURE!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 18:55:39' prior: 50872828!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	(self hasCartForUser: aUserName) ifTrue: [		^ (self cartForUser: aUserName) id].
	
	id _ self newCartId.
	carts add: (CartForUser cart: (CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue)) of: aUserName with: id). 
	^id! !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 18:55:42'!
ERROR!
!CartForUser methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:55:50'!
id
	self shouldBeImplemented.
	^id! !
!CartForUser methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:55:55' prior: 50873526!
id
	^id! !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 18:55:57'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 18:56:00'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 18:56:02'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:56:52' prior: 50871371!
test08
	"create cart of a user with an active cart returns a new cart"
	
	| store userName userPassword  actualCartId expectedCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	expectedCartId _ store createCartFor: userName with: userPassword.
	
	actualCartId _ store createCartFor: userName with: userPassword.
	
	self assert: expectedCartId equals: actualCartId
	
	

	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 18:57:05' prior: 50873662!
test08
	"create cart of a user with an active cart returns a new cart"
	
	| store userName userPassword  actualCartId expectedCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	expectedCartId _ store createCartFor: userName with: userPassword.
	
	actualCartId _ store createCartFor: userName with: userPassword.
	
	self deny: expectedCartId = actualCartId
	
	

	! !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 18:57:13'!
FAILURE!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 18:58:33' prior: 50873509!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	id _ self newCartId.
	carts add: (CartForUser cart: (CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue)) of: aUserName with: id). 
	^id! !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 18:58:35'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 18:58:36'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 19:00:44'!
PASSED!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 19:01:48' prior: 50873698!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	id _ self newCartId.
	self halt.
	carts add: (CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue) with: id). 
	^id! !

!classRemoval: #CartForUser stamp: 'lilmonk3y 6/22/2021 19:01:58'!
Object subclass: #CartForUser
	instanceVariableNames: 'cartSession userName id'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!methodRemoval: Store #cartForUser: stamp: 'lilmonk3y 6/22/2021 19:02:16'!
cartForUser: aUserName 
	^ carts detect: [:cart | cart isForUser: aUserName]!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:03:56' prior: 50873404!
getCartForId: aCartId

	^ carts at: aCartId ifAbsent: [self error: self class thereIsNotAnActiveCartForTheUserErrorDescription]! !
!Store methodsFor: 'initialization' stamp: 'lilmonk3y 6/22/2021 19:04:12' prior: 50872863!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: aClock   
	userAuth := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.
	salesbook := aSalesBook.
	clock := aClock.
	
	carts := Dictionary new.
	nextId := 0! !

!methodRemoval: Store #getCartXXX: stamp: 'lilmonk3y 6/22/2021 19:04:27'!
getCartXXX: aCartId 
	^ carts detect: [:cart | cart isForId: aCartId] ifNone: [self error: self class thereIsNotAnActiveCartForTheUserErrorDescription]!

!methodRemoval: Store #hasCartForUser: stamp: 'lilmonk3y 6/22/2021 19:05:15'!
hasCartForUser: aUserName 
	^carts anySatisfy: [:cart | cart isForUser: aUserName ] !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 19:06:22' prior: 50873834!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	id _ self newCartId.
	self halt.
	carts at: id put: (CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue)). 
	^id! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 19:07:49' prior: 50873229!
checkOut: cartId on: aCreditCard 
	| cart |
	cart _ self validateCartWasNotCheckouted: cartId.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	carts removeKey: cartId
	! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 19:07:53' prior: 50873901!
checkOut: cartId on: aCreditCard 
	| cart |
	cart _ self validateCartWasNotCheckouted: cartId.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	
	carts removeKey: cartId
	! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 19:08:15' prior: 50873890!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	id _ self newCartId.
	
	carts at: id put: (CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue)). 
	^id! !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 19:08:16'!
PASSED!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 19:11:53' prior: 50873913!
checkOut: cartId on: aCreditCard 
	
	(Cashier toCheckout: (self getCartForId: cartId) charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook) checkOut.
	
	carts removeKey: cartId
	! !

!classDefinition: #StoreTestObjectsFactory category: 'TusLibros' stamp: 'lilmonk3y 6/22/2021 19:17:41'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today validUsers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/22/2021 19:17:40' prior: 50867333!
authenticate: aUserName using: aUserPassword 
	^ validUsers includes: aUserName ! !
!StoreTestObjectsFactory methodsFor: 'initialization' stamp: 'lilmonk3y 6/22/2021 19:19:33' prior: 50866613 overrides: 16896425!
initialize

	today := DateAndTime now.
	
	validUsers := OrderedCollection with: (self validUserName) with: (self aSecondValidUserName).! !
!StoreTestObjectsFactory methodsFor: 'not-clasified' stamp: 'lilmonk3y 6/22/2021 19:19:57'!
aSecondValidUserName
	^  'Nico'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'lilmonk3y 6/22/2021 19:23:44'!
anotherItemSellByTheStore
	
	^ 'another validBook'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'lilmonk3y 6/22/2021 19:24:15'!
anotherItemSellByTheStorePrice
	
	^50! !
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'lilmonk3y 6/22/2021 19:25:10' prior: 50866592!
defaultCatalog
	
	^ Dictionary new
		at: self itemSellByTheStore put: self itemSellByTheStorePrice;
		at: self anotherItemSellByTheStore put: self anotherItemSellByTheStorePrice ;
		yourself ! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:27:51'!
test15
	"allow more than one active user in store"
	
	| store firstUserName firstUserPassword   cartId  anotherCartId firstUserPurcheses secondUserName secondUserPassword secondUserPurcheses |
	store _ factory createStore.
	
	firstUserName _ factory validUserName .
	firstUserPassword _ 'a password'.
	cartId _ store createCartFor: firstUserName with: firstUserPassword.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	secondUserName _ factory aSecondValidUserName.
	secondUserPassword _ 'another password'.
	anotherCartId _ store createCartFor: secondUserName with: secondUserPassword.
	store addToCart: anotherCartId bookNumbered: factory anotherItemSellByTheStore quantity: 5.
	store checkOut: anotherCartId on: factory notExpiredCreditCard.
	
	firstUserPurcheses _ store listPurcheses: firstUserName authBy: firstUserPassword.
	secondUserPurcheses _ store listPurcheses: secondUserName authBy: secondUserPassword.
	self deny: firstUserPurcheses = secondUserPurcheses.
	

	! !

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:28:14'!
FAILURE!
!Cashier class methodsFor: 'instance creation' stamp: 'lilmonk3y 6/22/2021 19:30:42'!
toCheckout: aCart charging: aCreditCard throught: aMerchantProcessor on: aDate registeringOn: aSalesBook for: aUserName 
	
	self assertIsNotEmpty: aCart.
	self assertIsNotExpired: aCreditCard on: aDate.
	
	^self new initializeToCheckout: aCart charging: aCreditCard throught: aMerchantProcessor registeringOn: aSalesBook! !

!methodRemoval: Cashier class #toCheckout:charging:throught:on:registeringOn: stamp: 'lilmonk3y 6/22/2021 19:30:42'!
toCheckout: aCart charging: aCreditCard throught: aMerchantProcessor on: aDate registeringOn: aSalesBook
	
	self assertIsNotEmpty: aCart.
	self assertIsNotExpired: aCreditCard on: aDate.
	
	^self new initializeToCheckout: aCart charging: aCreditCard throught: aMerchantProcessor registeringOn: aSalesBook!
!Cashier methodsFor: 'initialization' stamp: 'lilmonk3y 6/22/2021 19:31:15'!
initializeToCheckout: aCart charging: aCreditCard throught: aMerchantProcessor registeringOn: aSalesBook for: aUserName 
	
	cart := aCart.
	creditCard := aCreditCard.
	merchantProcessor := aMerchantProcessor.
	salesBook := aSalesBook! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:31:15' prior: 50874070!
toCheckout: aCart charging: aCreditCard throught: aMerchantProcessor on: aDate registeringOn: aSalesBook for: aUserName 
	
	self assertIsNotEmpty: aCart.
	self assertIsNotExpired: aCreditCard on: aDate.
	
	^self new initializeToCheckout: aCart charging: aCreditCard throught: aMerchantProcessor registeringOn: aSalesBook for: nil! !

!methodRemoval: Cashier #initializeToCheckout:charging:throught:registeringOn: stamp: 'lilmonk3y 6/22/2021 19:31:15'!
initializeToCheckout: aCart charging: aCreditCard throught: aMerchantProcessor registeringOn: aSalesBook
	
	cart := aCart.
	creditCard := aCreditCard.
	merchantProcessor := aMerchantProcessor.
	salesBook := aSalesBook!
!Cashier class methodsFor: 'instance creation' stamp: 'lilmonk3y 6/22/2021 19:31:21' prior: 50874107!
toCheckout: aCart charging: aCreditCard throught: aMerchantProcessor on: aDate registeringOn: aSalesBook for: aUserName 
	
	self assertIsNotEmpty: aCart.
	self assertIsNotExpired: aCreditCard on: aDate.
	
	^self new initializeToCheckout: aCart charging: aCreditCard throught: aMerchantProcessor registeringOn: aSalesBook for: aUserName ! !

!classDefinition: #Cashier category: 'TusLibros' stamp: 'lilmonk3y 6/22/2021 19:31:44'!
Object subclass: #Cashier
	instanceVariableNames: 'cart salesBook merchantProcessor creditCard total userName'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'initialization' stamp: 'lilmonk3y 6/22/2021 19:31:42' prior: 50874096!
initializeToCheckout: aCart charging: aCreditCard throught: aMerchantProcessor registeringOn: aSalesBook for: aUserName 
	
	cart := aCart.
	creditCard := aCreditCard.
	merchantProcessor := aMerchantProcessor.
	salesBook := aSalesBook.
	userName := aUserName ! !
!Cashier methodsFor: 'checkout - private' stamp: 'lilmonk3y 6/22/2021 19:33:27' prior: 50870963!
createSale

	^ Sale of: total items: (cart items)  
! !
!Sale class methodsFor: 'instance creation' stamp: 'lilmonk3y 6/22/2021 19:34:24'!
for: aUserName of: aTotal items: aListOfItems 

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal items: aListOfItems ! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:34:24' prior: 50874166!
createSale

	^ Sale for: nil of: total items: (cart items)  
! !

!methodRemoval: Sale class #of:items: stamp: 'lilmonk3y 6/22/2021 19:34:24'!
of: aTotal items: aListOfItems 

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal items: aListOfItems !
!Cashier methodsFor: 'checkout - private' stamp: 'lilmonk3y 6/22/2021 19:34:30' prior: 50874179!
createSale

	^ Sale for: userName of: total items: (cart items)  
! !
!Sale methodsFor: 'initialization' stamp: 'lilmonk3y 6/22/2021 19:35:35'!
initializeTotal: aTotal items: aListOfItems for: aUserName  

	total := aTotal.
	items := aListOfItems.! !
!Sale class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:35:35' prior: 50874171!
for: aUserName of: aTotal items: aListOfItems 

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal items: aListOfItems for: nil ! !

!methodRemoval: Sale #initializeTotal:items: stamp: 'lilmonk3y 6/22/2021 19:35:35'!
initializeTotal: aTotal items: aListOfItems 

	total := aTotal.
	items := aListOfItems.!
!Sale class methodsFor: 'instance creation' stamp: 'lilmonk3y 6/22/2021 19:35:44' prior: 50874203!
for: aUserName of: aTotal items: aListOfItems 

	"should assert total is not negative or 0!!"
	^self new initializeTotal: aTotal items: aListOfItems for: aUserName ! !

!classDefinition: #Sale category: 'TusLibros' stamp: 'lilmonk3y 6/22/2021 19:36:08'!
Object subclass: #Sale
	instanceVariableNames: 'total items userName'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Sale methodsFor: 'initialization' stamp: 'lilmonk3y 6/22/2021 19:36:05' prior: 50874196!
initializeTotal: aTotal items: aListOfItems for: aUserName  
	
	userName := aUserName.
	total := aTotal.
	items := aListOfItems.! !
!CashierTest methodsFor: 'tests' stamp: 'lilmonk3y 6/22/2021 19:39:50' prior: 50866446!
test01CanNotCheckoutAnEmptyCart

	| salesBook |
	
	salesBook := OrderedCollection new.
	self 
		should: [ Cashier 
			toCheckout: testObjectsFactory createCart 
			charging: testObjectsFactory notExpiredCreditCard 
			throught: self
			on: testObjectsFactory today
			registeringOn:  salesBook
			for: testObjectsFactory validUserName ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorMessage.
			self assert: salesBook isEmpty ]! !
!CashierTest methodsFor: 'tests' stamp: 'lilmonk3y 6/22/2021 19:40:04' prior: 50866464!
test02CalculatedTotalIsCorrect

	| cart cashier |
	
	cart := testObjectsFactory createCart.
	cart add: 2 of: testObjectsFactory itemSellByTheStore.
	
	cashier :=  Cashier
		toCheckout: cart 
		charging: testObjectsFactory notExpiredCreditCard 
		throught: self
		on: testObjectsFactory today 
		registeringOn: OrderedCollection new
		for: testObjectsFactory validUserName .
		
	self assert: cashier checkOut = (testObjectsFactory itemSellByTheStorePrice * 2)! !
!CashierTest methodsFor: 'tests' stamp: 'lilmonk3y 6/22/2021 19:40:13' prior: 50866357!
test03CanNotCheckoutWithAnExpiredCreditCart

	| cart salesBook |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	salesBook := OrderedCollection new.
	
	self
		should: [ Cashier 
				toCheckout: cart 
				charging: testObjectsFactory expiredCreditCard 
				throught: self
				on: testObjectsFactory today
				registeringOn: salesBook 
				for: testObjectsFactory validUserName ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | 
			self assert: anError messageText = Cashier canNotChargeAnExpiredCreditCardErrorMessage.
			self assert: salesBook isEmpty ]! !
!CashierTest methodsFor: 'tests' stamp: 'lilmonk3y 6/22/2021 19:40:25' prior: 50866378!
test04CheckoutRegistersASale

	| cart cashier salesBook total |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	salesBook := OrderedCollection new.
 
	cashier:= Cashier 
		toCheckout: cart 
		charging: testObjectsFactory notExpiredCreditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook
		for: testObjectsFactory validUserName .
		
	total := cashier checkOut.
					
	self assert: salesBook size = 1.
	self assert: salesBook first total = total.! !
!CashierTest methodsFor: 'tests' stamp: 'lilmonk3y 6/22/2021 19:40:35' prior: 50866422!
test05CashierChargesCreditCardUsingMerchantProcessor

	| cart cashier salesBook total creditCard debitedAmout debitedCreditCard  |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.
 
	cashier:= Cashier 
		toCheckout: cart 
		charging: creditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook 
		for: testObjectsFactory validUserName .
		
	debitBehavior := [ :anAmount :aCreditCard | 
		debitedAmout := anAmount.
		debitedCreditCard := aCreditCard ].
	total := cashier checkOut.
					
	self assert: debitedCreditCard = creditCard.
	self assert: debitedAmout = total.! !
!CashierTest methodsFor: 'tests' stamp: 'lilmonk3y 6/22/2021 19:40:50' prior: 50866396!
test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit

	| cart cashier salesBook creditCard |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.
 	debitBehavior := [ :anAmount :aCreditCard | self error: Cashier creditCardHasNoCreditErrorMessage].
	
	cashier:= Cashier 
		toCheckout: cart 
		charging: creditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook
		for: testObjectsFactory validUserName .
		
	self 
		should: [cashier checkOut ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardHasNoCreditErrorMessage.
			self assert: salesBook isEmpty ]! !
!Sale methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:41:47'!
isOf: aUserName
	^ userName  = aUserName ! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 19:43:30' prior: 50871285!
listPurcheses: aUserName authBy: aUserPassword
	self validateUserIsValid: aUserName with: aUserPassword. 
	^ salesbook select: [:sale | sale isOf: aUserName] ! !

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:43:40'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:46:50' prior: 50873925!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	id _ self newCartId.
	
	carts at: id put: (CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue) of: nil). 
	^id! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 19:47:17' prior: 50874391!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	id _ self newCartId.
	
	carts at: id put: (CartSession startSession: clock for: (Cart acceptingItemsOf: catalogue) of: aUserName). 
	^id! !
!CartSession class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:48:03'!
startSession: aClock for: aCart of: aUserName 
	^self new initializeClock: aClock cart: aCart! !

!methodRemoval: CartSession class #startSession:for: stamp: 'lilmonk3y 6/22/2021 19:48:03'!
startSession: aClock for: aCart
	^self new initializeClock: aClock cart: aCart!
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:48:28'!
initializeClock: aClock cart: aCart of: aUserName 
	clock := aClock.
	cart:= aCart.
	lastUpdate := clock today.! !
!CartSession class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:48:28' prior: 50874413!
startSession: aClock for: aCart of: aUserName 
	^self new initializeClock: aClock cart: aCart of: nil! !

!methodRemoval: CartSession #initializeClock:cart: stamp: 'lilmonk3y 6/22/2021 19:48:28'!
initializeClock: aClock cart: aCart
	clock := aClock.
	cart:= aCart.
	lastUpdate := clock today.!
!CartSession class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:48:33' prior: 50874432!
startSession: aClock for: aCart of: aUserName 
	^self new initializeClock: aClock cart: aCart of: aUserName ! !

!classDefinition: #CartSession category: 'TusLibros' stamp: 'lilmonk3y 6/22/2021 19:48:56'!
Object subclass: #CartSession
	instanceVariableNames: 'cart clock lastUpdate userName'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:48:55' prior: 50874425!
initializeClock: aClock cart: aCart of: aUserName 
	clock := aClock.
	cart:= aCart.
	userName := aUserName.
	lastUpdate := clock today.! !
!CartSession methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:49:50'!
userName
	^ userName ! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 19:50:20' prior: 50873974!
checkOut: cartId on: aCreditCard 
	
	| cart |
	(Cashier toCheckout: (self getCartForId: cartId) charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook for: cart) checkOut.
	
	carts removeKey: cartId
	! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 19:50:57' prior: 50874472!
checkOut: cartId on: aCreditCard 
	
	| cart |
	cart _ self getCartForId: cartId.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessorSimulator on: clock today registeringOn: salesbook for: cart userName ) checkOut.
	
	carts removeKey: cartId
	! !

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:51:00'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/22/2021 19:51:03'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:51:04'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:51:07'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 19:54:23' prior: 50874031!
test15
	"allow more than one active user in store"
	
	| store firstUserName firstUserPassword   cartId  anotherCartId firstUserPurcheses secondUserName secondUserPassword secondUserPurcheses |
	store _ factory createStore.
	
	firstUserName _ factory validUserName .
	firstUserPassword _ 'a password'.
	cartId _ store createCartFor: firstUserName with: firstUserPassword.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	secondUserName _ factory aSecondValidUserName.
	secondUserPassword _ 'another password'.
	anotherCartId _ store createCartFor: secondUserName with: secondUserPassword.
	store addToCart: anotherCartId bookNumbered: factory anotherItemSellByTheStore quantity: 5.
	store checkOut: anotherCartId on: factory notExpiredCreditCard.
	
	firstUserPurcheses _ store listPurcheses: firstUserName authBy: firstUserPassword.
	secondUserPurcheses _ store listPurcheses: secondUserName authBy: secondUserPassword.
	self deny: firstUserPurcheses = secondUserPurcheses.
	
	self assert: 1 equals: firstUserPurcheses size.
	self assert: (firstUserPurcheses first isOf: firstUserName).
	
	self assert: 1 equals: secondUserPurcheses size.
	self assert: (secondUserPurcheses first isOf: secondUserName ).
	
	

	! !

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:54:25'!
PASSED!

!methodRemoval: StoreTest #aListOfTest stamp: 'lilmonk3y 6/22/2021 19:55:23'!
aListOfTest
	
	'allow more than one active user in store'.
		'multiple cart creation'.
		'multiple listing of carts'.
		'multiple checkout of carts'.
		'multiple adding to carts'.
	!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 19:55:52'!
PASSED!

TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #CartTest category: 'TusLibros-Tests' stamp: 'lilmonk3y 6/22/2021 19:57:09'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #CashierTest category: 'TusLibros-Tests' stamp: 'lilmonk3y 6/22/2021 19:57:27'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

Object subclass: #ClockDouble
	instanceVariableNames: 'dateAndTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #ClockDouble category: 'TusLibros-Tests' stamp: 'lilmonk3y 6/22/2021 19:57:35'!
Object subclass: #ClockDouble
	instanceVariableNames: 'dateAndTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

TestCase subclass: #StoreTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #StoreTest category: 'TusLibros-Tests' stamp: 'lilmonk3y 6/22/2021 19:57:45'!
TestCase subclass: #StoreTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today validUsers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #StoreTestObjectsFactory category: 'TusLibros-Tests' stamp: 'lilmonk3y 6/22/2021 19:57:52'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today validUsers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!CartSession class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:02:48'!
of: aUserName startSession: aClock for: aCart 
	^self new initializeClock: aClock cart: aCart of: aUserName ! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:02:48' prior: 50874402!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	id _ self newCartId.
	
	carts at: id put: (CartSession of: clock startSession: (Cart acceptingItemsOf: catalogue) for: aUserName). 
	^id! !

!methodRemoval: CartSession class #startSession:for:of: stamp: 'lilmonk3y 6/22/2021 20:02:48'!
startSession: aClock for: aCart of: aUserName 
	^self new initializeClock: aClock cart: aCart of: aUserName !
!CartSession class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:03:29'!
of: aUserName validatingWith: aClock for: aCart 
	^self new initializeClock: aClock cart: aCart of: aUserName ! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:03:29' prior: 50875053!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	id _ self newCartId.
	
	carts at: id put: (CartSession of: clock validatingWith: (Cart acceptingItemsOf: catalogue) for: aUserName). 
	^id! !

!methodRemoval: CartSession class #of:startSession:for: stamp: 'lilmonk3y 6/22/2021 20:03:29'!
of: aUserName startSession: aClock for: aCart 
	^self new initializeClock: aClock cart: aCart of: aUserName !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 20:03:39'!
ERROR!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 20:04:28'!
ERROR!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 20:05:17' prior: 50875078!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserIsValid: aUserName with: aUserPassword.	
	
	id _ self newCartId.
	
	carts at: id put: (CartSession of: aUserName validatingWith: clock  for: (Cart acceptingItemsOf: catalogue)). 
	^id! !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 20:05:18'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/22/2021 20:05:18'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/22/2021 20:05:18'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/22/2021 20:05:18'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/22/2021 20:05:18'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 20:05:19'!
PASSED!
!CartSession methodsFor: 'dispatching' stamp: 'lilmonk3y 6/22/2021 20:07:58' prior: 50872442 overrides: 16881366!
doesNotUnderstand: aMessage
	lastUpdate + 30 minutes > clock today ifFalse: [self error: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription].
	lastUpdate _ clock today.
	
	[^aMessage sendTo: cart] on: MessageNotUnderstood do: [super doesNotUnderstand: aMessage ].
	! !
!CartSession methodsFor: 'dispatching' stamp: 'lilmonk3y 6/22/2021 20:09:07'!
validateCartSessionLength

	^ lastUpdate + 30 minutes > clock today ifFalse: [self error: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription]! !
!CartSession methodsFor: 'dispatching' stamp: 'lilmonk3y 6/22/2021 20:09:07' prior: 50875202 overrides: 16881366!
doesNotUnderstand: aMessage
	self validateCartSessionLength.
	lastUpdate _ clock today.
	
	[^aMessage sendTo: cart] on: MessageNotUnderstood do: [super doesNotUnderstand: aMessage ].
	! !
!CartSession methodsFor: 'dispatching' stamp: 'lilmonk3y 6/22/2021 20:09:58' prior: 50875223 overrides: 16881366!
doesNotUnderstand: aMessage
	self validateCartSessionLength.
	
	lastUpdate _ clock today.
	
	[^aMessage sendTo: cart] on: MessageNotUnderstood do: [super doesNotUnderstand: aMessage ].
	! !

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 20:10:08'!
PASSED!

Object subclass: #NameOfSubclass
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #NameOfSubclass category: 'TusLibros-Tests' stamp: 'lilmonk3y 6/22/2021 20:11:38'!
Object subclass: #NameOfSubclass
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classRemoval: #NameOfSubclass stamp: 'lilmonk3y 6/22/2021 20:11:52'!
Object subclass: #NameOfSubclass
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

TestCase subclass: #MerchantProcessorSimulator
	instanceVariableNames: 'debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #MerchantProcessorSimulator category: 'TusLibros-Tests' stamp: 'lilmonk3y 6/22/2021 20:12:08'!
TestCase subclass: #MerchantProcessorSimulator
	instanceVariableNames: 'debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:14:57' prior: 50868398!
authBy: anAuthService withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessorSimulator salesbook: aSalesBook withClock: aClock   
	^ self new initializeWith: anAuthService catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: aClock  ! !
!Store class methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:15:07' prior: 50875363!
authBy: anAuthService withCatalogue: aCatalogue withMerchantProcessor: aMerchantProcessor salesbook: aSalesBook withClock: aClock   
	^ self new initializeWith: anAuthService catalogue: aCatalogue on: aMerchantProcessor registerOn: aSalesBook withClock: aClock  ! !

!methodRemoval: Store #validateCartWasNotCheckouted: stamp: 'lilmonk3y 6/22/2021 20:17:30'!
validateCartWasNotCheckouted: cartId
	^[self getCartForId: cartId] on: Error do: [self error: self class thereIsNotAnActiveCartForTheUserErrorDescription]!

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/22/2021 20:17:56'!
Object subclass: #Store
	instanceVariableNames: 'authService catalogue cartSession merchantProcessorSimulator salesbook clock nextId carts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:17:56' prior: 50873864!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: aClock   
	authService := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessorSimulator := aMerchantProcessorSimulator.
	salesbook := aSalesBook.
	clock := aClock.
	
	carts := Dictionary new.
	nextId := 0! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:17:56' prior: 50871244!
validateUserIsValid: aUserName with: aUserPassword

	^ (authService authenticate: aUserName using: aUserPassword) ifFalse: [self error: self class userNotValidErrorDescription]! !
!Store methodsFor: 'validations' stamp: 'lilmonk3y 6/22/2021 20:18:45'!
validateUserCredentials: aUserName with: aUserPassword

	^ (authService authenticate: aUserName using: aUserPassword) ifFalse: [self error: self class userNotValidErrorDescription]! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:18:45' prior: 50875101!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserCredentials: aUserName with: aUserPassword.	
	
	id _ self newCartId.
	
	carts at: id put: (CartSession of: aUserName validatingWith: clock  for: (Cart acceptingItemsOf: catalogue)). 
	^id! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:18:45' prior: 50874380!
listPurcheses: aUserName authBy: aUserPassword
	self validateUserCredentials: aUserName with: aUserPassword. 
	^ salesbook select: [:sale | sale isOf: aUserName] ! !

!methodRemoval: Store #validateUserIsValid:with: stamp: 'lilmonk3y 6/22/2021 20:18:45'!
validateUserIsValid: aUserName with: aUserPassword

	^ (authService authenticate: aUserName using: aUserPassword) ifFalse: [self error: self class userNotValidErrorDescription]!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 20:19:23' prior: 50875436!
createCartFor: aUserName with: aUserPassword 
	| id |
	self validateUserCredentials: aUserName with: aUserPassword.	
	
	id _ self newCartId.
	carts at: id put: (CartSession of: aUserName validatingWith: clock  for: (Cart acceptingItemsOf: catalogue)). 
	^id! !

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 20:19:29'!
PASSED!
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 20:20:35' prior: 50873381!
addToCart: aCartId bookNumbered: item quantity: amountOfItems
	
	(self getCartForId: aCartId) add: amountOfItems of: item.! !

!classDefinition: #Store category: 'TusLibros' stamp: 'lilmonk3y 6/22/2021 20:21:45'!
Object subclass: #Store
	instanceVariableNames: 'authService catalogue cartSession merchantProcessor salesbook clock nextId carts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:21:45' prior: 50875405!
initializeWith: aUserAuth catalogue: aCatalogue on: aMerchantProcessorSimulator registerOn: aSalesBook withClock: aClock   
	authService := aUserAuth.
	catalogue := aCatalogue.
	merchantProcessor := aMerchantProcessorSimulator.
	salesbook := aSalesBook.
	clock := aClock.
	
	carts := Dictionary new.
	nextId := 0! !
!Store methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:21:45' prior: 50874483!
checkOut: cartId on: aCreditCard 
	
	| cart |
	cart _ self getCartForId: cartId.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessor on: clock today registeringOn: salesbook for: cart userName ) checkOut.
	
	carts removeKey: cartId
	! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 20:22:40' prior: 50875594!
checkOut: cartId on: aCreditCard 
	
	| cart |
	cart _ self getCartForId: cartId.
	
	(Cashier toCheckout: cart charging: aCreditCard throught: merchantProcessor on: (clock today) registeringOn: salesbook for: (cart userName)) checkOut.
	
	carts removeKey: cartId
	! !
!Store methodsFor: 'store-protocol' stamp: 'lilmonk3y 6/22/2021 20:22:50' prior: 50875448!
listPurcheses: aUserName authBy: aUserPassword

	self validateUserCredentials: aUserName with: aUserPassword. 
	^ salesbook select: [:sale | sale isOf: aUserName] ! !

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 20:23:14'!
PASSED!

!methodRemoval: StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 20:30:39'!
test13
	"creating a cart for a user that already has a cart does not resets its life time"
	
	| store userName userPassword  clock cartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 35.
	store createCartFor: userName with: userPassword.
	
	self should: [store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	

	!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:30:56'!
test13
	"listing operations of a user with more than one checkouted cart must return all of them"
	
	| store userName userPassword  clock cartId newCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	newCartId _ store createCartFor: userName with: userPassword.
	
	self deny: cartId = newCartId
	

	! !

!methodRemoval: StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 20:30:56'!
test14
	"listing operations of a user with more than one checkouted cart must return all of them"
	
	| store userName userPassword  clock cartId newCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	newCartId _ store createCartFor: userName with: userPassword.
	
	self deny: cartId = newCartId
	

	!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:31:07'!
test14
	"allow more than one active user in store"
	
	| store firstUserName firstUserPassword   cartId  anotherCartId firstUserPurcheses secondUserName secondUserPassword secondUserPurcheses |
	store _ factory createStore.
	
	firstUserName _ factory validUserName .
	firstUserPassword _ 'a password'.
	cartId _ store createCartFor: firstUserName with: firstUserPassword.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	secondUserName _ factory aSecondValidUserName.
	secondUserPassword _ 'another password'.
	anotherCartId _ store createCartFor: secondUserName with: secondUserPassword.
	store addToCart: anotherCartId bookNumbered: factory anotherItemSellByTheStore quantity: 5.
	store checkOut: anotherCartId on: factory notExpiredCreditCard.
	
	firstUserPurcheses _ store listPurcheses: firstUserName authBy: firstUserPassword.
	secondUserPurcheses _ store listPurcheses: secondUserName authBy: secondUserPassword.
	self deny: firstUserPurcheses = secondUserPurcheses.
	
	self assert: 1 equals: firstUserPurcheses size.
	self assert: (firstUserPurcheses first isOf: firstUserName).
	
	self assert: 1 equals: secondUserPurcheses size.
	self assert: (secondUserPurcheses first isOf: secondUserName ).
	
	

	! !

!methodRemoval: StoreTest #test15 stamp: 'lilmonk3y 6/22/2021 20:31:07'!
test15
	"allow more than one active user in store"
	
	| store firstUserName firstUserPassword   cartId  anotherCartId firstUserPurcheses secondUserName secondUserPassword secondUserPurcheses |
	store _ factory createStore.
	
	firstUserName _ factory validUserName .
	firstUserPassword _ 'a password'.
	cartId _ store createCartFor: firstUserName with: firstUserPassword.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	secondUserName _ factory aSecondValidUserName.
	secondUserPassword _ 'another password'.
	anotherCartId _ store createCartFor: secondUserName with: secondUserPassword.
	store addToCart: anotherCartId bookNumbered: factory anotherItemSellByTheStore quantity: 5.
	store checkOut: anotherCartId on: factory notExpiredCreditCard.
	
	firstUserPurcheses _ store listPurcheses: firstUserName authBy: firstUserPassword.
	secondUserPurcheses _ store listPurcheses: secondUserName authBy: secondUserPassword.
	self deny: firstUserPurcheses = secondUserPurcheses.
	
	self assert: 1 equals: firstUserPurcheses size.
	self assert: (firstUserPurcheses first isOf: firstUserName).
	
	self assert: 1 equals: secondUserPurcheses size.
	self assert: (secondUserPurcheses first isOf: secondUserName ).
	
	

	!

!methodRemoval: StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 20:32:28'!
test13
	"listing operations of a user with more than one checkouted cart must return all of them"
	
	| store userName userPassword  clock cartId newCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	newCartId _ store createCartFor: userName with: userPassword.
	
	self deny: cartId = newCartId
	

	!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'lilmonk3y 6/22/2021 20:32:45'!
test13
	"allow more than one active user in store"
	
	| store firstUserName firstUserPassword   cartId  anotherCartId firstUserPurcheses secondUserName secondUserPassword secondUserPurcheses |
	store _ factory createStore.
	
	firstUserName _ factory validUserName .
	firstUserPassword _ 'a password'.
	cartId _ store createCartFor: firstUserName with: firstUserPassword.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	secondUserName _ factory aSecondValidUserName.
	secondUserPassword _ 'another password'.
	anotherCartId _ store createCartFor: secondUserName with: secondUserPassword.
	store addToCart: anotherCartId bookNumbered: factory anotherItemSellByTheStore quantity: 5.
	store checkOut: anotherCartId on: factory notExpiredCreditCard.
	
	firstUserPurcheses _ store listPurcheses: firstUserName authBy: firstUserPassword.
	secondUserPurcheses _ store listPurcheses: secondUserName authBy: secondUserPassword.
	self deny: firstUserPurcheses = secondUserPurcheses.
	
	self assert: 1 equals: firstUserPurcheses size.
	self assert: (firstUserPurcheses first isOf: firstUserName).
	
	self assert: 1 equals: secondUserPurcheses size.
	self assert: (secondUserPurcheses first isOf: secondUserName ).
	
	

	! !

!methodRemoval: StoreTest #test14 stamp: 'lilmonk3y 6/22/2021 20:32:45'!
test14
	"allow more than one active user in store"
	
	| store firstUserName firstUserPassword   cartId  anotherCartId firstUserPurcheses secondUserName secondUserPassword secondUserPurcheses |
	store _ factory createStore.
	
	firstUserName _ factory validUserName .
	firstUserPassword _ 'a password'.
	cartId _ store createCartFor: firstUserName with: firstUserPassword.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	secondUserName _ factory aSecondValidUserName.
	secondUserPassword _ 'another password'.
	anotherCartId _ store createCartFor: secondUserName with: secondUserPassword.
	store addToCart: anotherCartId bookNumbered: factory anotherItemSellByTheStore quantity: 5.
	store checkOut: anotherCartId on: factory notExpiredCreditCard.
	
	firstUserPurcheses _ store listPurcheses: firstUserName authBy: firstUserPassword.
	secondUserPurcheses _ store listPurcheses: secondUserName authBy: secondUserPassword.
	self deny: firstUserPurcheses = secondUserPurcheses.
	
	self assert: 1 equals: firstUserPurcheses size.
	self assert: (firstUserPurcheses first isOf: firstUserName).
	
	self assert: 1 equals: secondUserPurcheses size.
	self assert: (secondUserPurcheses first isOf: secondUserName ).
	
	

	!
!StoreTest methodsFor: 'basic-protocol' stamp: 'lilmonk3y 6/22/2021 20:34:40' prior: 50867606!
test03AddAnItemToACart

	| store userName userPassword cartId books isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	isbn _ factory itemSellByTheStore.
	
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	books _ store listCart: cartId.
	self assert: books size equals: 2.
	self assert: ( books includes: isbn).
	self assert: (books occurrencesOf: isbn) equals: 2.

	! !

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'lilmonk3y 6/22/2021 20:34:43'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test01UserNotValid stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test02CreateCartForValidUser stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test03AddAnItemToACart stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test04CheckOutACart stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 20:34:44'!
PASSED!
!StoreTest methodsFor: 'validations-on-model' stamp: 'lilmonk3y 6/22/2021 20:36:19'!
test05cannotAddAnItemToaCartAlreadyCheckouted
	"cannot add an item to a cart already checkouted"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 1] 
		raise: Error 
		withMessageText: Store thereIsNotAnActiveCartForTheUserErrorDescription
	

	! !

!methodRemoval: StoreTest #test05 stamp: 'lilmonk3y 6/22/2021 20:36:19'!
test05
	"cannot add an item to a cart already checkouted"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 1] 
		raise: Error 
		withMessageText: Store thereIsNotAnActiveCartForTheUserErrorDescription
	

	!
!StoreTest methodsFor: 'validations-on-model' stamp: 'lilmonk3y 6/22/2021 20:36:29' prior: 50876079!
test05cannotAddAnItemToaCartAlreadyCheckouted
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 1] 
		raise: Error 
		withMessageText: Store thereIsNotAnActiveCartForTheUserErrorDescription
	

	! !
!StoreTest methodsFor: 'validations-on-model' stamp: 'lilmonk3y 6/22/2021 20:37:40'!
test06cannotCheckOutAnAlreadyCheckoutedCart
	"cannot check out an already checkouted cart"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard] 
		raise: Error 
		withMessageText: Store thereIsNotAnActiveCartForTheUserErrorDescription
	

	! !

!methodRemoval: StoreTest #test06 stamp: 'lilmonk3y 6/22/2021 20:37:40'!
test06
	"cannot check out an already checkouted cart"
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard] 
		raise: Error 
		withMessageText: Store thereIsNotAnActiveCartForTheUserErrorDescription
	

	!
!StoreTest methodsFor: 'validations-on-model' stamp: 'lilmonk3y 6/22/2021 20:37:45' prior: 50876144!
test06cannotCheckOutAnAlreadyCheckoutedCart
	
	| store userName userPassword cartId isbn |
	userName _ factory validUserName.
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	store _ factory createStore.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard] 
		raise: Error 
		withMessageText: Store thereIsNotAnActiveCartForTheUserErrorDescription
	

	! !
!StoreTest methodsFor: 'validations-on-model' stamp: 'lilmonk3y 6/22/2021 20:38:45'!
test07cannotListPurchesesOfAUserNotAuthenticated
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword  |
	userName _ factory notValidUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	
	self should: [store listPurcheses: userName authBy: userPassword] 
		raise: Error 
		withMessageText: Store userNotValidErrorDescription 
	

	! !

!methodRemoval: StoreTest #test07 stamp: 'lilmonk3y 6/22/2021 20:38:45'!
test07
	"cannot list purcheses of a user not authenticated"
	
	| store userName userPassword  |
	userName _ factory notValidUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	
	self should: [store listPurcheses: userName authBy: userPassword] 
		raise: Error 
		withMessageText: Store userNotValidErrorDescription 
	

	!
!StoreTest methodsFor: 'validations-on-model' stamp: 'lilmonk3y 6/22/2021 20:38:49' prior: 50876208!
test07cannotListPurchesesOfAUserNotAuthenticated
	
	| store userName userPassword  |
	userName _ factory notValidUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	
	self should: [store listPurcheses: userName authBy: userPassword] 
		raise: Error 
		withMessageText: Store userNotValidErrorDescription 
	

	! !
!StoreTest methodsFor: 'validations-on-model' stamp: 'lilmonk3y 6/22/2021 20:39:29'!
test08createCartOfAUserWithAnActiveCartReturnsANewCart
	"create cart of a user with an active cart returns a new cart"
	
	| store userName userPassword  actualCartId expectedCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	expectedCartId _ store createCartFor: userName with: userPassword.
	
	actualCartId _ store createCartFor: userName with: userPassword.
	
	self deny: expectedCartId = actualCartId
	
	

	! !

!methodRemoval: StoreTest #test08 stamp: 'lilmonk3y 6/22/2021 20:39:29'!
test08
	"create cart of a user with an active cart returns a new cart"
	
	| store userName userPassword  actualCartId expectedCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	expectedCartId _ store createCartFor: userName with: userPassword.
	
	actualCartId _ store createCartFor: userName with: userPassword.
	
	self deny: expectedCartId = actualCartId
	
	

	!
!StoreTest methodsFor: 'validations-on-model' stamp: 'lilmonk3y 6/22/2021 20:39:37' prior: 50876251!
test08createCartOfAUserWithAnActiveCartReturnsANewCart
	
	| store userName userPassword  actualCartId expectedCartId |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	store _ factory createStore.
	expectedCartId _ store createCartFor: userName with: userPassword.
	
	actualCartId _ store createCartFor: userName with: userPassword.
	
	self deny: expectedCartId = actualCartId
	
	

	! !
!StoreTest methodsFor: 'time-modeling' stamp: 'lilmonk3y 6/22/2021 20:41:33'!
test09cannotAddAnItemToACartThatWasNotUsedInTheLast30Minutes
	"cannot add an item to a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 2] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !

!methodRemoval: StoreTest #test09 stamp: 'lilmonk3y 6/22/2021 20:41:33'!
test09
	"cannot add an item to a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 2] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	!
!StoreTest methodsFor: 'time-modeling' stamp: 'lilmonk3y 6/22/2021 20:42:09' prior: 50876301!
test09cannotAddAnItemToACartThatWasNotUsedInTheLast30Minutes
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store addToCart: cartId bookNumbered: isbn quantity: 2] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !
!StoreTest methodsFor: 'time-modeling' stamp: 'lilmonk3y 6/22/2021 20:42:28'!
test10cannotCheckoutACartThatWasNotUsedInTheLast30Minutes
	"cannot checkout a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	clock advanceMinutesBy: 35.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard ] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !

!methodRemoval: StoreTest #test10 stamp: 'lilmonk3y 6/22/2021 20:42:28'!
test10
	"cannot checkout a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	clock advanceMinutesBy: 35.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard ] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	!
!StoreTest methodsFor: 'time-modeling' stamp: 'lilmonk3y 6/22/2021 20:42:32' prior: 50876367!
test10cannotCheckoutACartThatWasNotUsedInTheLast30Minutes
	
	| store userName userPassword  cartId clock isbn |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	isbn _ factory itemSellByTheStore.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	store addToCart: cartId bookNumbered: isbn quantity: 2.
	
	clock advanceMinutesBy: 35.
	
	self should: [store checkOut: cartId on: factory notExpiredCreditCard ] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !
!StoreTest methodsFor: 'time-modeling' stamp: 'lilmonk3y 6/22/2021 20:43:10'!
test11cannotListTheItemsOfACartThatWasNotUsedInTheLast30Minutes
	"cannot list the items of a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock  |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store listCart: cartId] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !

!methodRemoval: StoreTest #test11 stamp: 'lilmonk3y 6/22/2021 20:43:10'!
test11
	"cannot list the items of a cart that was not used in the last 30 minutes"
	
	| store userName userPassword  cartId clock  |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store listCart: cartId] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	!
!StoreTest methodsFor: 'time-modeling' stamp: 'lilmonk3y 6/22/2021 20:43:17' prior: 50876438!
test11cannotListTheItemsOfACartThatWasNotUsedInTheLast30Minutes
	
	| store userName userPassword  cartId clock  |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.
	
	clock advanceMinutesBy: 35.
	
	self should: [store listCart: cartId] 
		raise: Error 
		withMessageText: Store cartInactivatedDueNotUsedForMoreThanThirtyMinutesErrorDescription
	
	

	! !
!StoreTest methodsFor: 'time-modeling' stamp: 'lilmonk3y 6/22/2021 20:43:57'!
test12multipleAccionsOnACartExtendsItsLifeTime
	"multiple accions on a cart extends its life time"
	
	| store userName userPassword  cartId clock  cartItems sales |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 29.
	store listCart: cartId.
	clock advanceMinutesBy: 29.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	cartItems _ store listCart: cartId. 
	clock advanceMinutesBy: 29.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	sales _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: sales size.
	self assert: cartItems equals: (sales first items).
	
	

	! !

!methodRemoval: StoreTest #test12 stamp: 'lilmonk3y 6/22/2021 20:43:57'!
test12
	"multiple accions on a cart extends its life time"
	
	| store userName userPassword  cartId clock  cartItems sales |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 29.
	store listCart: cartId.
	clock advanceMinutesBy: 29.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	cartItems _ store listCart: cartId. 
	clock advanceMinutesBy: 29.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	sales _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: sales size.
	self assert: cartItems equals: (sales first items).
	
	

	!
!StoreTest methodsFor: 'time-modeling' stamp: 'lilmonk3y 6/22/2021 20:44:01' prior: 50876498!
test12multipleAccionsOnACartExtendsItsLifeTime
	
	| store userName userPassword  cartId clock  cartItems sales |
	userName _ factory validUserName .
	userPassword _ 'a password'.
	clock _ ClockDouble timedAt: factory today.
	store _ factory createStoreWith: clock.
	cartId _ store createCartFor: userName with: userPassword.

	clock advanceMinutesBy: 29.
	store listCart: cartId.
	clock advanceMinutesBy: 29.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	cartItems _ store listCart: cartId. 
	clock advanceMinutesBy: 29.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	sales _ store listPurcheses: userName authBy: userPassword .
	self assert: 1 equals: sales size.
	self assert: cartItems equals: (sales first items).
	
	

	! !
!StoreTest methodsFor: 'checkout-more-than-one' stamp: 'lilmonk3y 6/22/2021 20:44:22' prior: 50875889!
test13
	
	| store firstUserName firstUserPassword   cartId  anotherCartId firstUserPurcheses secondUserName secondUserPassword secondUserPurcheses |
	store _ factory createStore.
	
	firstUserName _ factory validUserName .
	firstUserPassword _ 'a password'.
	cartId _ store createCartFor: firstUserName with: firstUserPassword.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	secondUserName _ factory aSecondValidUserName.
	secondUserPassword _ 'another password'.
	anotherCartId _ store createCartFor: secondUserName with: secondUserPassword.
	store addToCart: anotherCartId bookNumbered: factory anotherItemSellByTheStore quantity: 5.
	store checkOut: anotherCartId on: factory notExpiredCreditCard.
	
	firstUserPurcheses _ store listPurcheses: firstUserName authBy: firstUserPassword.
	secondUserPurcheses _ store listPurcheses: secondUserName authBy: secondUserPassword.
	self deny: firstUserPurcheses = secondUserPurcheses.
	
	self assert: 1 equals: firstUserPurcheses size.
	self assert: (firstUserPurcheses first isOf: firstUserName).
	
	self assert: 1 equals: secondUserPurcheses size.
	self assert: (secondUserPurcheses first isOf: secondUserName ).
	
	

	! !
!StoreTest methodsFor: 'checkout-more-than-one' stamp: 'lilmonk3y 6/22/2021 20:44:34'!
test13allowMoreThanOneActiveUserInStore
	
	| store firstUserName firstUserPassword   cartId  anotherCartId firstUserPurcheses secondUserName secondUserPassword secondUserPurcheses |
	store _ factory createStore.
	
	firstUserName _ factory validUserName .
	firstUserPassword _ 'a password'.
	cartId _ store createCartFor: firstUserName with: firstUserPassword.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	secondUserName _ factory aSecondValidUserName.
	secondUserPassword _ 'another password'.
	anotherCartId _ store createCartFor: secondUserName with: secondUserPassword.
	store addToCart: anotherCartId bookNumbered: factory anotherItemSellByTheStore quantity: 5.
	store checkOut: anotherCartId on: factory notExpiredCreditCard.
	
	firstUserPurcheses _ store listPurcheses: firstUserName authBy: firstUserPassword.
	secondUserPurcheses _ store listPurcheses: secondUserName authBy: secondUserPassword.
	self deny: firstUserPurcheses = secondUserPurcheses.
	
	self assert: 1 equals: firstUserPurcheses size.
	self assert: (firstUserPurcheses first isOf: firstUserName).
	
	self assert: 1 equals: secondUserPurcheses size.
	self assert: (secondUserPurcheses first isOf: secondUserName ).
	
	

	! !

!methodRemoval: StoreTest #test13 stamp: 'lilmonk3y 6/22/2021 20:44:34'!
test13
	
	| store firstUserName firstUserPassword   cartId  anotherCartId firstUserPurcheses secondUserName secondUserPassword secondUserPurcheses |
	store _ factory createStore.
	
	firstUserName _ factory validUserName .
	firstUserPassword _ 'a password'.
	cartId _ store createCartFor: firstUserName with: firstUserPassword.
	store addToCart: cartId bookNumbered: factory itemSellByTheStore quantity: 2.
	store checkOut: cartId on: factory notExpiredCreditCard.
	
	secondUserName _ factory aSecondValidUserName.
	secondUserPassword _ 'another password'.
	anotherCartId _ store createCartFor: secondUserName with: secondUserPassword.
	store addToCart: anotherCartId bookNumbered: factory anotherItemSellByTheStore quantity: 5.
	store checkOut: anotherCartId on: factory notExpiredCreditCard.
	
	firstUserPurcheses _ store listPurcheses: firstUserName authBy: firstUserPassword.
	secondUserPurcheses _ store listPurcheses: secondUserName authBy: secondUserPassword.
	self deny: firstUserPurcheses = secondUserPurcheses.
	
	self assert: 1 equals: firstUserPurcheses size.
	self assert: (firstUserPurcheses first isOf: firstUserName).
	
	self assert: 1 equals: secondUserPurcheses size.
	self assert: (secondUserPurcheses first isOf: secondUserName ).
	
	

	!